{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global console, document, Excel, Office */\n\n// APIURL - HTTPS\nconst API_BASE_URL = 'https://localhost:4000';\n\n// \nlet uploadedProtocol = null;\n\n// Wizard state\nlet currentWizardStep = 1; // 1: Welcome, 2: Resume, 3: Project, 4: Upload, 5: SDTM\n\nfunction initWizard() {\n  const backBtn = document.getElementById('wizard-back-btn');\n  const nextBtn = document.getElementById('wizard-next-btn');\n  backBtn.addEventListener('click', async () => {\n    // BackStep 2\n    if (currentWizardStep === 3) {\n      showStep(1);  // Step 3  Step 1 (Step 2)\n    } else if (currentWizardStep > 1) {\n      showStep(currentWizardStep - 1);\n    }\n  });\n  nextBtn.addEventListener('click', async () => { await handleNext(); });\n  \n  // \n  initChatInterface();\n  \n  showStep(1);\n}\n\n// \nfunction initChatInterface() {\n  const chatInput = document.getElementById('chat-input');\n  const chatSendBtn = document.getElementById('chat-send-btn');\n  \n  if (chatInput && chatSendBtn) {\n    // \n    chatSendBtn.addEventListener('click', handleChatSend);\n    \n    // \n    chatInput.addEventListener('keypress', (e) => {\n      if (e.key === 'Enter' && !e.shiftKey) {\n        e.preventDefault();\n        handleChatSend();\n      }\n    });\n    \n    // \n    chatInput.addEventListener('input', () => {\n      const sendBtn = document.getElementById('chat-send-btn');\n      const hasText = chatInput.value.trim().length > 0;\n      sendBtn.disabled = !hasText;\n    });\n  }\n}\n\n// \nlet lastParsedCommand = null;\n\n//       \nasync function handleChatSend() {\n  const chatInput = document.getElementById('chat-input');\n  const userMessage = chatInput.value.trim();\n  if (!userMessage) return;\n\n  addChatMessage(userMessage, 'user');\n  chatInput.value = '';\n  document.getElementById('chat-send-btn').disabled = true;\n\n  // \n  if (window.pendingConfirmation) {\n    await handleConfirmationResponse(userMessage);\n    return;\n  }\n\n  showTypingIndicator();\n  try {\n    const parsed = await callAssistantParseCommand(userMessage);\n    hideTypingIndicator();\n\n    if (!parsed || (!parsed.studyIdentifier && !parsed.matchedTask)) {\n      // \"\"\n      if (userMessage.toLowerCase().includes('start') || userMessage.toLowerCase().includes('new project') || userMessage.toLowerCase().includes('upload')) {\n        addChatMessage(\"Let me take you to start a new project by uploading your protocol.\", 'ai');\n        await delayedNavigation(3);\n        return;\n      }\n      addChatMessage(\"I couldn't understand the study number or task. Supported tasks are: Cost Estimate, SAS Analysis. Please try e.g. 'I want to do Cost Estimate for study SK123-KBI', or say 'start new project'.\", 'ai');\n      return;\n    }\n\n    lastParsedCommand = parsed;\n    const studyText = parsed.studyIdentifier ? parsed.studyIdentifier : '(study number not provided)';\n    const taskText = parsed.matchedTask ? parsed.matchedTask.name : '(task not recognized)';\n    askForConfirmation(studyText, taskText, parsed.matchedTask ? parsed.matchedTask.key : null);\n      } catch (e) {\n      hideTypingIndicator();\n      addChatMessage('Sorry, parsing failed. Please try again, or say \"start new project\" to proceed with upload.', 'ai');\n    }\n}\n\nasync function callAssistantParseCommand(text) {\n  const resp = await fetch(`${API_BASE_URL}/api/v2/parse-command`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ text })\n  });\n  if (!resp.ok) throw new Error('parse failed');\n  const data = await resp.json();\n  return data?.data || null;\n}\n\nfunction askForConfirmation(studyIdentifier, taskName, taskKey) {\n  const msg = `Did you mean you want ${taskName} for study ${studyIdentifier}?`;\n  addChatMessage(msg, 'ai');\n  \n  // \n  window.pendingConfirmation = {\n    studyIdentifier,\n    taskName,\n    taskKey\n  };\n}\n\nasync function handleConfirmationResponse(userMessage) {\n  showTypingIndicator();\n  \n  try {\n    // AIYes/No\n    const intent = await parseYesNoIntent(userMessage);\n    hideTypingIndicator();\n    \n    if (intent === 'yes') {\n      const { studyIdentifier, taskKey } = window.pendingConfirmation;\n      if (!taskKey) {\n        addChatMessage('Task not recognized. Supported tasks: Cost Estimate, SAS Analysis. Please rephrase your request.', 'ai');\n        window.pendingConfirmation = null;\n        return;\n      }\n      \n      showTypingIndicator();\n      try {\n        const lookup = await callAssistantLookupStudyTask(studyIdentifier, taskKey);\n        hideTypingIndicator();\n        window.pendingConfirmation = null;\n        await handleLookupResult(lookup);\n      } catch (err) {\n        hideTypingIndicator();\n        addChatMessage('Lookup failed. Let me take you to start a new project.', 'ai');\n        window.pendingConfirmation = null;\n        await delayedNavigation(3);\n      }\n    } else if (intent === 'no') {\n      window.pendingConfirmation = null;\n      addChatMessage(\"Please tell me again what you want to do. For example: 'I want to do Cost Estimate for study SK123-KBI'.\", 'ai');\n    } else {\n      addChatMessage(\"I couldn't understand if you meant yes or no. Please respond with something like 'yes', 'no', 'correct', or 'not correct'.\", 'ai');\n    }\n  } catch (e) {\n    hideTypingIndicator();\n    addChatMessage(\"Sorry, I couldn't process your response. Please say 'yes' or 'no'.\", 'ai');\n  } finally {\n    document.getElementById('chat-send-btn').disabled = false;\n  }\n}\n\nasync function parseYesNoIntent(text) {\n  const resp = await fetch(`${API_BASE_URL}/api/v2/parse-command`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ \n      text: `Parse this as yes/no intent: \"${text}\". Return only \"yes\", \"no\", or \"unclear\".`,\n      type: 'yesno_intent'\n    })\n  });\n  \n  if (!resp.ok) throw new Error('Intent parsing failed');\n  const data = await resp.json();\n  \n  // \n  const lowerText = text.toLowerCase().trim();\n  \n  // Yes\n  const yesPatterns = [\n    'yes', 'y', 'yeah', 'yep', 'correct', 'right', 'true', 'ok', 'okay', \n    'sure', 'exactly', 'that\\'s right', 'confirm', 'confirmed', 'agreed'\n  ];\n  \n  // No  \n  const noPatterns = [\n    'no', 'n', 'nope', 'wrong', 'incorrect', 'false', 'not right', \n    'not correct', 'that\\'s wrong', 'cancel', 'redo'\n  ];\n  \n  if (yesPatterns.some(pattern => lowerText.includes(pattern))) {\n    return 'yes';\n  } else if (noPatterns.some(pattern => lowerText.includes(pattern))) {\n    return 'no';\n  }\n  \n  return 'unclear';\n}\n\nasync function callAssistantLookupStudyTask(studyIdentifier, taskKey) {\n  const resp = await fetch(`${API_BASE_URL}/api/v2/lookup-study-task`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ studyIdentifier, taskKey })\n  });\n  if (!resp.ok) throw new Error('lookup failed');\n  const data = await resp.json();\n  return data?.data || null;\n}\n\nasync function handleLookupResult(data) {\n  if (!data || data.foundStudy === false) {\n    addChatMessage(\"We could not find any records for this study. Let me take you to start a new one.\", 'ai');\n    await delayedNavigation(3);\n    return;\n  }\n\n  // foundStudy === true\n  if (data.isUnfinished === true && data.documentId) {\n    addChatMessage(`I found an unfinished '${data.taskName}' for study '${data.studyNumber}'. Loading it now...`, 'ai');\n    window.currentDocumentId = data.documentId;\n    await saveDocumentIdToSettings(data.documentId);\n    await delayedNavigationWithCallback(5, async () => {\n      await restoreApplicationState(data.documentId);\n    });\n    return;\n  }\n\n  addChatMessage(\"We could not check unfinished project for this study. Let me take you to start a new one.\", 'ai');\n  await delayedNavigation(3);\n}\n\n// \nasync function delayedNavigation(targetStep, delayMs = 2000) {\n  // AI\n  await new Promise(resolve => setTimeout(resolve, delayMs));\n  \n  // \n  const countdownDiv = document.createElement('div');\n  countdownDiv.className = 'message ai-message';\n  countdownDiv.innerHTML = `<div class=\"message-content\" style=\"font-style: italic; color: #666; border: 1px solid #e0e0e0; background-color: #f8f9fa; padding: 8px; border-radius: 6px;\">Preparing to redirect...</div>`;\n  \n  const chatMessages = document.getElementById('chat-messages');\n  chatMessages.appendChild(countdownDiv);\n  chatMessages.scrollTop = chatMessages.scrollHeight;\n  \n  // 1\n  await new Promise(resolve => setTimeout(resolve, 1000));\n  countdownDiv.remove();\n  showStep(targetStep);\n}\n\n// \nasync function delayedNavigationWithCallback(targetStep, callback, delayMs = 2000) {\n  // AI\n  await new Promise(resolve => setTimeout(resolve, delayMs));\n  \n  // \n  const countdownDiv = document.createElement('div');\n  countdownDiv.className = 'message ai-message';\n  countdownDiv.innerHTML = `<div class=\"message-content\" style=\"font-style: italic; color: #666; border: 1px solid #e0e0e0; background-color: #f8f9fa; padding: 8px; border-radius: 6px;\">Loading previous work...</div>`;\n  \n  const chatMessages = document.getElementById('chat-messages');\n  chatMessages.appendChild(countdownDiv);\n  chatMessages.scrollTop = chatMessages.scrollHeight;\n  \n  // 1\n  await new Promise(resolve => setTimeout(resolve, 1000));\n  countdownDiv.remove();\n  \n  if (callback) await callback();\n  showStep(targetStep);\n}\n\n// \nfunction addChatMessage(message, sender) {\n  const chatMessages = document.getElementById('chat-messages');\n  const messageDiv = document.createElement('div');\n  messageDiv.className = `message ${sender}-message`;\n  \n  const contentDiv = document.createElement('div');\n  contentDiv.className = 'message-content';\n  \n  contentDiv.textContent = message;\n  \n  messageDiv.appendChild(contentDiv);\n  chatMessages.appendChild(messageDiv);\n  \n  // \n  chatMessages.scrollTop = chatMessages.scrollHeight;\n}\n\n// \nfunction showTypingIndicator() {\n  const chatMessages = document.getElementById('chat-messages');\n  const typingDiv = document.createElement('div');\n  typingDiv.className = 'message ai-message typing-indicator';\n  typingDiv.id = 'typing-indicator';\n  \n  const contentDiv = document.createElement('div');\n  contentDiv.className = 'message-content';\n  contentDiv.innerHTML = '<strong>LLX AI:</strong> <span class=\"typing-dots\">Thinking<span>.</span><span>.</span><span>.</span></span>';\n  \n  typingDiv.appendChild(contentDiv);\n  chatMessages.appendChild(typingDiv);\n  chatMessages.scrollTop = chatMessages.scrollHeight;\n}\n\n// \nfunction hideTypingIndicator() {\n  const typingIndicator = document.getElementById('typing-indicator');\n  if (typingIndicator) {\n    typingIndicator.remove();\n  }\n}\n\n// AI\nfunction generateAIResponse(userMessage) {\n  const lowerMessage = userMessage.toLowerCase();\n  \n  // \n  if (lowerMessage.includes('phase') || lowerMessage.includes('study') || lowerMessage.includes('trial')) {\n    if (lowerMessage.includes('phase i') || lowerMessage.includes('phase 1')) {\n      return \"Great! I understand you're working on a Phase I study. Phase I trials typically focus on safety and dosing. I'll help you set up a cost analysis that includes SDTM mapping, safety monitoring, and PK assessments. Click 'Next' to begin the protocol upload.\";\n    } else if (lowerMessage.includes('phase ii') || lowerMessage.includes('phase 2')) {\n      return \"Excellent! Phase II studies focus on efficacy while continuing safety monitoring. I'll guide you through setting up cost estimates for SDTM datasets, efficacy endpoints, and interim analyses. Click 'Next' to start with your protocol.\";\n    } else if (lowerMessage.includes('phase iii') || lowerMessage.includes('phase 3')) {\n      return \"Perfect! Phase III trials are large confirmatory studies. I'll help you plan for extensive SDTM/ADaM datasets, multiple interim analyses, and comprehensive safety reporting. Let's begin with uploading your protocol - click 'Next'.\";\n    }\n  }\n  \n  // \n  if (lowerMessage.includes('oncology') || lowerMessage.includes('cancer')) {\n    return \"Oncology trials have specific requirements including tumor assessments, survival endpoints, and specialized SDTM domains like TU (Tumor Identification) and RS (Disease Response). I'll help you set up the appropriate cost structure. Click 'Next' to upload your protocol.\";\n  }\n  \n  // SDTM\n  if (lowerMessage.includes('sdtm') || lowerMessage.includes('mapping')) {\n    return \"SDTM mapping is crucial for regulatory submissions! I'll analyze your protocol's Schedule of Assessments and automatically map procedures to appropriate SDTM domains, then estimate the complexity and costs. Ready to start? Click 'Next' to upload your protocol.\";\n  }\n  \n  // \n  if (lowerMessage.includes('cost') || lowerMessage.includes('estimate') || lowerMessage.includes('budget')) {\n    return \"I'll help you create a comprehensive cost analysis including SDTM/ADaM production, statistical analysis plans, interim analyses, and data transfers. The system will automatically calculate costs based on your protocol complexity. Let's get started - click 'Next'!\";\n  }\n  \n  // \n  return \"I understand you want to work on a clinical study project. I can help you with cost estimation, SDTM mapping, and data management planning. To get started, please click 'Next' to upload your protocol document, and I'll guide you through the entire process step by step.\";\n}\n\nfunction showStep(step) {\n  currentWizardStep = step;\n  const pages = document.querySelectorAll('.wizard-page');\n  pages.forEach(p => {\n    const s = Number(p.getAttribute('data-step'));\n    p.style.display = (s === step) ? 'block' : 'none';\n  });\n  \n  const backBtn = document.getElementById('wizard-back-btn');\n  const nextBtn = document.getElementById('wizard-next-btn');\n  const navContainer = document.querySelector('.wizard-nav');\n  \n  if (step === 1) {\n    // Step 1 (AI Assistant): \n    if (navContainer) navContainer.style.display = 'none';\n  } else {\n    // \n    if (navContainer) navContainer.style.display = 'flex';\n    backBtn.disabled = (step === 1);  // Step 1Back\n    nextBtn.disabled = false;\n    nextBtn.querySelector('.ms-Button-label').textContent = (step === 6) ? 'Done' : 'Next';\n  }\n}\n\n\n\nasync function handleNext() {\n  if (currentWizardStep === 1) {\n    showStep(3);\n    return;\n  }\n  if (currentWizardStep === 3) {\n    //   \n    if (!window.currentDocumentId) {\n      showStatusMessage('Please upload a protocol document before proceeding.', 'error');\n      return;\n    }\n    showStep(5);\n    return;\n  }\n  if (currentWizardStep === 5) {\n    //   Excel  \n    if (window.currentDocumentId) {\n      try { await saveProjectSelectionDetails(); } catch (e) { console.warn(':', e); }\n    }\n    await createStandardCostAnalysisHeaders();\n    await populateExcelWithSelectedProjects();\n\n    // \n    if (!window.currentDocumentId) {\n      showStatusMessage('Missing document id. Please upload again.', 'error');\n      return;\n    }\n    showStep(4);\n    try {\n      const resp = await fetch(`${API_BASE_URL}/api/documents/${window.currentDocumentId}/analyze-sdtm`, { method: 'POST' });\n      const result = await resp.json();\n      if (result?.success) {\n        showStatusMessage('SDTM analysis completed.', 'success');\n      } else {\n        showStatusMessage('SDTM analysis failed or incomplete. You can review later.', 'error');\n      }\n    } catch (e) {\n      console.warn(':', e);\n      showStatusMessage('Failed to start analysis. You can review later.', 'error');\n    }\n\n    // \n    try {\n      const response = await fetch(`${API_BASE_URL}/api/documents/${window.currentDocumentId}/content`);\n      if (response.ok) {\n        const docData = await response.json();\n        const sdtmData = docData?.document?.sdtmData;\n        if (sdtmData) {\n          const hasValidConfirmed = !!(sdtmData.confirmed && sdtmData.confirmed.summary && (\n            (typeof sdtmData.confirmed.summary.total_sdtm_domains === 'number' && sdtmData.confirmed.summary.total_sdtm_domains > 0) ||\n            (Array.isArray(sdtmData.confirmed.summary.unique_domains) && sdtmData.confirmed.summary.unique_domains.length > 0)\n          ));\n          const source = hasValidConfirmed ? sdtmData.confirmed : sdtmData.original;\n          if (source && source.procedures) {\n            displaySDTMAnalysis(source);\n          }\n        }\n      }\n    } catch (e) { console.warn('SDTMSDTM:', e); }\n\n    showStep(6);\n    return;\n  }\n  if (currentWizardStep === 6) {\n    // Done isCostEstimate = trueExcel\n    if (!window.currentDocumentId) {\n      showStatusMessage('Missing document id. Please upload again.', 'error');\n      return;\n    }\n    try {\n      const resp = await fetch(`${API_BASE_URL}/api/documents/${window.currentDocumentId}/mark-complete`, { method: 'PATCH' });\n      const result = await resp.json();\n      if (result?.success) {\n        showStatusMessage('Project completed! Saving Excel file and starting fresh...', 'success');\n        \n        // Excel\n        await saveExcelToLocal();\n        \n        // Excel\n        await clearExcelContent();\n        \n        // \n        await resetToStart();\n        \n      } else {\n        showStatusMessage('Failed to mark as completed: ' + (result?.message || ''), 'error');\n      }\n    } catch (err) {\n      showStatusMessage('Failed to mark as completed: ' + err.message, 'error');\n    }\n  }\n}\n\n// \n(function attachWizardInit(){\n  const origOnReady = Office.onReady;\n  //  Office.onReady  initWizard Office.onReady\n})();\n\nasync function checkAndOfferResume() {\n  try {\n    // 1)  documentId\n    const savedDocumentId = await loadDocumentIdFromSettings();\n    if (savedDocumentId) {\n      await restoreApplicationState(savedDocumentId);\n      return; // \n    }\n\n    // 2) \n    const resp = await fetch(`${API_BASE_URL}/api/documents/incomplete-estimates`);\n    const data = await resp.json();\n    const list = Array.isArray(data?.data) ? data.data : [];\n\n    // 3) \n    const modal = document.getElementById('start-modal');\n    const listEl = document.getElementById('incomplete-list');\n    const btnNew = document.getElementById('start-new-btn');\n    const btnContinue = document.getElementById('continue-selected-btn');\n    const titleEl = document.getElementById('start-modal-title');\n    const descEl = document.getElementById('start-modal-desc');\n\n    let selectedId = null;\n\n    // 4) \n    if (list.length > 0) {\n      titleEl.textContent = 'Welcome back';\n      descEl.textContent = 'We found unfinished studies. Continue or start a new estimate?';\n      btnContinue.style.display = '';\n      btnContinue.setAttribute('disabled', 'true');\n      listEl.classList.add('has-items');\n      listEl.innerHTML = '';\n      list.forEach(doc => {\n        const div = document.createElement('div');\n        div.className = 'item';\n        const title = (doc.studyNumber && doc.studyNumber !== 'N/A') ? doc.studyNumber : '(No Study Number)';\n        const subtitle = doc.originalName || '';\n        const uploaded = doc.uploadedAt ? new Date(doc.uploadedAt).toLocaleString() : '';\n        div.innerHTML = `\n          <div class=\"check\"></div>\n          <div class=\"info\">\n            <div class=\"title\">${title}</div>\n            <div class=\"subtitle\">${subtitle}</div>\n            <div class=\"meta\">Uploaded: ${uploaded}</div>\n          </div>\n        `;\n        div.addEventListener('click', () => {\n          Array.from(listEl.children).forEach(c => c.classList.remove('selected'));\n          div.classList.add('selected');\n          selectedId = doc._id;\n          btnContinue.removeAttribute('disabled');\n        });\n        listEl.appendChild(div);\n      });\n    } else {\n      titleEl.textContent = 'Start a New Cost Estimate?';\n      descEl.textContent = 'No unfinished studies found. Would you like to start a new one?';\n      btnContinue.style.display = 'none';\n      listEl.classList.remove('has-items');\n      listEl.innerHTML = '';\n    }\n\n    // 5) \n    modal.style.display = 'flex';\n\n    btnNew.onclick = () => {\n      modal.style.display = 'none';\n      showStep(1); // \n    };\n    btnContinue.onclick = async () => {\n      if (!selectedId) { showStatusMessage('Please select a study to continue.', 'error'); return; }\n      modal.style.display = 'none';\n      await saveDocumentIdToSettings(selectedId);\n      await restoreApplicationState(selectedId);\n      showStep(3);\n    };\n  } catch (err) {\n    console.warn(':', err);\n    // \n    try {\n      const modal = document.getElementById('start-modal');\n      const listEl = document.getElementById('incomplete-list');\n      const btnNew = document.getElementById('start-new-btn');\n      const btnContinue = document.getElementById('continue-selected-btn');\n      const titleEl = document.getElementById('start-modal-title');\n      const descEl = document.getElementById('start-modal-desc');\n      titleEl.textContent = 'Start a New Cost Estimate?';\n      descEl.textContent = 'We could not check unfinished studies. You can still start a new one.';\n      btnContinue.style.display = 'none';\n      listEl.classList.remove('has-items');\n      listEl.innerHTML = '';\n      modal.style.display = 'flex';\n      btnNew.onclick = () => { modal.style.display = 'none'; showStep(1); };\n    } catch (_) {}\n  }\n}\n\n//  Office.onReady \nOffice.onReady(async (info) => {\n  if (info.host === Office.HostType.Excel) {\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\n    document.getElementById(\"app-body\").style.display = \"flex\";\n    \n    initWizard();\n    initFileUpload();\n\n    // documentId5\n    try {\n      const savedDocumentId = await loadDocumentIdFromSettings();\n      if (savedDocumentId) {\n        await restoreApplicationState(savedDocumentId);\n        showStep(5);\n      } else {\n        showStep(1);\n      }\n    } catch (error) {\n      console.error(' :', error);\n      showStep(1);\n    }\n  }\n});\n\n// \nfunction initFileUpload() {\n  // Protocol upload\n  const protocolSelectBtn = document.getElementById('protocol-select-btn');\n  const protocolFileInput = document.getElementById('protocol-file-input');\n  const protocolUploadArea = document.getElementById('protocol-upload-area');\n  const protocolCancelBtn = document.getElementById('protocol-cancel-btn');\n  const protocolRemoveBtn = document.getElementById('protocol-remove-btn');\n\n\n\n  // Protocol upload events\n  protocolSelectBtn.addEventListener('click', () => protocolFileInput.click());\n  protocolUploadArea.addEventListener('click', () => protocolFileInput.click());\n  protocolFileInput.addEventListener('change', (e) => handleProtocolUpload(e.target.files[0]));\n  protocolCancelBtn.addEventListener('click', cancelProtocolUpload);\n  protocolRemoveBtn.addEventListener('click', removeProtocolFile);\n\n  // Drag and drop for protocol\n  protocolUploadArea.addEventListener('dragover', handleDragOver);\n  protocolUploadArea.addEventListener('drop', (e) => handleProtocolDrop(e));\n  protocolUploadArea.addEventListener('dragenter', handleDragEnter);\n  protocolUploadArea.addEventListener('dragleave', handleDragLeave);\n\n  //  \n  initProjectSelectionLogic();\n  \n\n\n}\n\n// \nfunction handleDragOver(e) {\n  e.preventDefault();\n  e.dataTransfer.dropEffect = 'copy';\n}\n\nfunction handleDragEnter(e) {\n  e.preventDefault();\n  e.currentTarget.classList.add('dragover');\n}\n\nfunction handleDragLeave(e) {\n  e.preventDefault();\n  e.currentTarget.classList.remove('dragover');\n}\n\nfunction handleProtocolDrop(e) {\n  e.preventDefault();\n  e.currentTarget.classList.remove('dragover');\n  const files = e.dataTransfer.files;\n  if (files.length > 0) {\n    handleProtocolUpload(files[0]);\n  }\n}\n\n\n\n// ProtocolExcel\nasync function handleProtocolUpload(file) {\n  if (!file) return;\n\n  const allowedTypes = [ 'application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' ];\n  if (!allowedTypes.includes(file.type)) {\n    showStatusMessage('Please select PDF or Word documents only', 'error');\n    return;\n  }\n\n  showProtocolProgress();\n  try {\n    const formData = new FormData();\n    formData.append('document', file);\n    formData.append('documentType', 'ClinicalProtocol');\n\n    const response = await fetch(`${API_BASE_URL}/api/upload-document`, { method: 'POST', body: formData });\n    if (!response.ok) { throw new Error(`Upload failed: ${response.statusText}`); }\n    const result = await response.json();\n\n    uploadedProtocol = { name: file.name, size: file.size, type: file.type, uploadId: result.uploadId };\n\n    if (result.uploadId) {\n      window.currentDocumentId = result.uploadId;\n      await saveDocumentIdToSettings(result.uploadId);\n    }\n\n    showProtocolResult(file);\n    showStatusMessage('Clinical Protocol uploaded. Click Next to select projects.', 'success');\n  } catch (error) {\n    console.error('Protocol upload error:', error);\n    showStatusMessage(`Upload failed: ${error.message}`, 'error');\n    hideProtocolProgress();\n  }\n}\n\n\n\n// UI\nfunction showProtocolProgress() {\n  document.getElementById('protocol-upload-area').style.display = 'none';\n  document.getElementById('protocol-progress').style.display = 'block';\n  document.getElementById('protocol-result').style.display = 'none';\n}\n\nfunction hideProtocolProgress() {\n  document.getElementById('protocol-upload-area').style.display = 'block';\n  document.getElementById('protocol-progress').style.display = 'none';\n}\n\nfunction showProtocolResult(file) {\n  document.getElementById('protocol-upload-area').style.display = 'none';\n  document.getElementById('protocol-progress').style.display = 'none';\n  document.getElementById('protocol-result').style.display = 'block';\n  \n  document.getElementById('protocol-file-name').textContent = file.name;\n  document.getElementById('protocol-file-status').textContent = ' Clinical Protocol uploaded to MongoDB';\n}\n\nfunction cancelProtocolUpload() {\n  hideProtocolProgress();\n  showStatusMessage('Protocol upload cancelled', 'info');\n  }\n\nasync function removeProtocolFile() {\n  uploadedProtocol = null;\n  window.currentDocumentId = null;\n  currentSDTMData = null;\n  \n  document.getElementById('protocol-upload-area').style.display = 'block';\n  document.getElementById('protocol-result').style.display = 'none';\n  document.getElementById('protocol-file-input').value = '';\n  \n  // SDTM\n  hideSDTMAnalysis();\n  \n  //  Excel\n  await clearDocumentIdFromSettings();\n  \n  // \n  const checkboxes = document.querySelectorAll('.project-options input[type=\"checkbox\"]');\n  checkboxes.forEach(checkbox => {\n    checkbox.checked = false;\n    const dataAttr = checkbox.getAttribute('data-requires-count');\n    if (dataAttr) {\n      const container = document.getElementById(`${dataAttr}-container`);\n      const input = document.getElementById(`${dataAttr}-count`);\n      if (container) container.style.display = 'none';\n      if (input) input.value = '';\n    }\n  });\n  \n  showStatusMessage('Clinical Protocol removed', 'info');\n}\n\n\n\n\n\n// \nfunction formatFileSize(bytes) {\n  if (bytes === 0) return '0 Bytes';\n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n}\n\nfunction showStatusMessage(message, type) {\n  const statusElement = document.getElementById('status-message');\n  statusElement.textContent = message;\n  statusElement.className = `status-message ${type}`;\n  \n  if (type === 'success' || type === 'info') {\n    setTimeout(() => {\n  statusElement.className = 'status-message';\n    }, 3000);\n  }\n}\n\n//   - Excel/ID\nasync function saveDocumentIdToSettings(documentId) {\n  try {\n    await Excel.run(async (context) => {\n      const settings = context.workbook.settings;\n      \n      // \n      try {\n        settings.getItem(\"currentDocumentId\").delete();\n      } catch (e) {\n        // \n      }\n      \n      // \n      settings.add(\"currentDocumentId\", documentId);\n      await context.sync();\n      console.log(' IDExcel:', documentId);\n    });\n  } catch (error) {\n    console.error(' ID:', error);\n  }\n}\n\nasync function loadDocumentIdFromSettings() {\n  try {\n    return await Excel.run(async (context) => {\n      const settings = context.workbook.settings;\n      const documentIdSetting = settings.getItem(\"currentDocumentId\");\n      context.load(documentIdSetting, \"value\");\n      await context.sync();\n      \n      if (documentIdSetting.value) {\n        console.log(' ExcelID:', documentIdSetting.value);\n        return documentIdSetting.value;\n      }\n      return null;\n    });\n  } catch (error) {\n    console.error(' ID:', error);\n    return null;\n  }\n}\n\nasync function clearDocumentIdFromSettings() {\n  try {\n    await Excel.run(async (context) => {\n      context.workbook.settings.getItem(\"currentDocumentId\").delete();\n      await context.sync();\n      console.log(' ExcelID');\n    });\n  } catch (error) {\n    console.error(' ID:', error);\n  }\n}\n\n//   - ID\nasync function restoreApplicationState(documentId) {\n  try {\n    window.currentDocumentId = documentId;\n    showStatusMessage('...', 'info');\n    \n    // 1. \n    const response = await fetch(`${API_BASE_URL}/api/documents/${documentId}/content`);\n    if (!response.ok) {\n      throw new Error('Failed to fetch document data');\n    }\n    \n    const docData = await response.json();\n    if (!docData.success) {\n      throw new Error(docData.message || 'Failed to get document content');\n    }\n    \n    const document = docData.document;\n    \n    // 2. SDTM\n    if (document.sdtmData && (document.sdtmData.confirmed || document.sdtmData.original)) {\n      const sdtmData = document.sdtmData.confirmed || document.sdtmData.original;\n      if (sdtmData && sdtmData.procedures) {\n        currentSDTMData = {\n          success: true, //  success  true\n          procedures: sdtmData.procedures,\n          mappings: sdtmData.mappings || [],\n          summary: sdtmData.summary || {}\n        };\n        \n        // SDTM\n        displaySDTMAnalysis(currentSDTMData);\n        showStatusMessage('SDTM', 'success');\n      }\n    }\n    \n    // 3. \n    if (document.projectSelectionDetails) {\n      restoreProjectSelections(document.projectSelectionDetails);\n    }\n    \n    // 4. Excel\n    await createStandardCostAnalysisHeaders();\n    await populateExcelWithSelectedProjects();\n    \n    showStatusMessage('', 'success');\n    \n  } catch (error) {\n    console.error(' :', error);\n    showStatusMessage(': ' + error.message, 'error');\n  }\n}\n\n//  \nfunction restoreProjectSelections(projectSelectionDetails) {\n  try {\n    // \n    const checkboxes = document.querySelectorAll('.project-options input[type=\"checkbox\"]');\n    checkboxes.forEach(checkbox => {\n      checkbox.checked = false;\n      // \n      const dataAttr = checkbox.getAttribute('data-requires-count');\n      if (dataAttr) {\n        const container = document.getElementById(`${dataAttr}-container`);\n        if (container) {\n          container.style.display = 'none';\n        }\n      }\n    });\n    \n    // \n    Object.entries(projectSelectionDetails).forEach(([projectName, count]) => {\n      if (projectName === 'lastUpdated') return;\n      \n      // checkbox\n      const checkbox = Array.from(checkboxes).find(cb => {\n        const label = cb.nextElementSibling;\n        if (label && label.classList.contains('ms-CheckBox-label')) {\n          const textSpan = label.querySelector('.ms-CheckBox-text');\n          return textSpan && textSpan.textContent.trim() === projectName;\n        }\n        return false;\n      });\n      \n      if (checkbox) {\n        checkbox.checked = true;\n        \n        // \n        const dataAttr = checkbox.getAttribute('data-requires-count');\n        if (dataAttr && count && count > 0) {\n          const container = document.getElementById(`${dataAttr}-container`);\n          const input = document.getElementById(`${dataAttr}-count`);\n          if (container && input) {\n            container.style.display = 'flex';\n            input.value = count;\n          }\n        }\n      }\n    });\n    \n    console.log(' ');\n  } catch (error) {\n    console.error(' :', error);\n  }\n}\n\n// SDTM\nlet currentSDTMData = null;\nlet isEditMode = false;\nlet selectedProcedureIndex = 0;\n\n// SDTM\nfunction displaySDTMAnalysis(sdtmAnalysis) {\n  console.log('SDTM:', sdtmAnalysis);\n  \n  //  success \n  const inferredSuccess = (sdtmAnalysis && (\n    sdtmAnalysis.success === true ||\n    (sdtmAnalysis.success === undefined && Array.isArray(sdtmAnalysis.procedures) && sdtmAnalysis.procedures.length > 0)\n  ));\n\n  currentSDTMData = {\n    success: inferredSuccess === true,\n    procedures: [...(sdtmAnalysis.procedures || [])],\n    mappings: [...(sdtmAnalysis.mappings || [])],\n    summary: { ...(sdtmAnalysis.summary || {}) }\n  };\n  \n  const sdtmSection = document.getElementById('sdtm-analysis-section');\n  const sdtmStatus = document.getElementById('sdtm-status');\n  const sdtmStatusText = document.getElementById('sdtm-status-text');\n  const sdtmMappingsContainer = document.getElementById('sdtm-mappings-container');\n  \n  // SDTM\n  sdtmSection.style.display = 'block';\n  \n  const isOk = currentSDTMData.success === true;\n  if (isOk) {\n    // \n    sdtmStatus.style.display = 'block';\n    sdtmStatus.className = 'sdtm-status success';\n    sdtmStatusText.textContent = 'SDTM analysis completed successfully - Please review and confirm';\n    \n    // \n    updateSummaryStats();\n    \n    // \n    if (currentSDTMData.mappings && currentSDTMData.mappings.length > 0) {\n      sdtmMappingsContainer.style.display = 'block';\n      displayFlatMappingsList(currentSDTMData);\n      setupSDTMEventListeners();\n  } else {\n      //  mappings procedures \n      sdtmMappingsContainer.style.display = 'block';\n      displayFlatMappingsList(currentSDTMData);\n      setupSDTMEventListeners();\n    }\n    \n  } else {\n    // \n    sdtmStatus.style.display = 'block';\n    sdtmStatus.className = 'sdtm-status error';\n    sdtmStatusText.textContent = sdtmAnalysis.message || 'SDTM analysis failed';\n  }\n}\n\n// \nfunction updateSummaryAndDomainOverview(summary) {\n  // \n  document.getElementById('total-procedures').textContent = summary.total_procedures || 0;\n  document.getElementById('total-domains').textContent = summary.total_sdtm_domains || 0;\n  \n  // \n  const domainsOverview = document.getElementById('domains-list-overview');\n  domainsOverview.innerHTML = '';\n  \n  if (summary.unique_domains && summary.unique_domains.length > 0) {\n    summary.unique_domains.forEach(domain => {\n      const domainTag = document.createElement('span');\n      domainTag.className = 'domain-overview-tag';\n      domainTag.textContent = domain;\n      domainsOverview.appendChild(domainTag);\n    });\n  }\n  \n  // SDTM\n  const highComplexityOverview = document.getElementById('high-complexity-domains');\n  highComplexityOverview.innerHTML = '';\n  \n  if (summary.highComplexitySdtm && summary.highComplexitySdtm.domains && summary.highComplexitySdtm.domains.length > 0) {\n    summary.highComplexitySdtm.domains.forEach(domain => {\n      const domainTag = document.createElement('span');\n      domainTag.className = 'domain-overview-tag';\n      domainTag.textContent = domain;\n      highComplexityOverview.appendChild(domainTag);\n    });\n  }\n  \n  // SDTM\n  const mediumComplexityOverview = document.getElementById('medium-complexity-domains');\n  mediumComplexityOverview.innerHTML = '';\n  \n  if (summary.mediumComplexitySdtm && summary.mediumComplexitySdtm.domains && summary.mediumComplexitySdtm.domains.length > 0) {\n    summary.mediumComplexitySdtm.domains.forEach(domain => {\n      const domainTag = document.createElement('span');\n      domainTag.className = 'domain-overview-tag';\n      domainTag.textContent = domain;\n      mediumComplexityOverview.appendChild(domainTag);\n    });\n  }\n}\n\n// \nfunction displayFlatMappingsList(data) {\n  const flatMappingsList = document.getElementById('flat-mappings-list');\n  flatMappingsList.innerHTML = '';\n  \n  if (!data.procedures || data.procedures.length === 0) {\n    flatMappingsList.innerHTML = '<div style=\"text-align: center; color: #666; padding: 20px;\">No procedures found</div>';\n    return;\n  }\n  \n  //  proceduresmappings\n  data.procedures.forEach((procedure, index) => {\n    // proceduremapping\n    const mapping = data.mappings ? data.mappings.find(m => m.procedure === procedure) : null;\n    \n    // mapping\n    const procedureMapping = {\n      procedure: procedure,\n      sdtm_domains: mapping ? mapping.sdtm_domains : []\n    };\n    \n    const mappingRow = createMappingRow(procedureMapping, index);\n    flatMappingsList.appendChild(mappingRow);\n  });\n}\n\n// \nfunction createMappingRow(mapping, index) {\n  const row = document.createElement('div');\n  row.className = 'mapping-row';\n  row.dataset.index = index;\n  \n  // Procedure\n  const procedureName = document.createElement('div');\n  procedureName.className = 'procedure-name';\n  procedureName.textContent = mapping.procedure;\n  \n  // Domains\n  const domainsArea = document.createElement('div');\n  domainsArea.className = 'domains-area';\n  \n  // domain\n  if (mapping.sdtm_domains && mapping.sdtm_domains.length > 0) {\n    mapping.sdtm_domains.forEach((domain, domainIndex) => {\n      const domainTag = createEditableDomainTag(domain, index, domainIndex);\n      domainsArea.appendChild(domainTag);\n    });\n  }\n  \n  // \"Domain\"\n  const addBtn = document.createElement('div');\n  addBtn.className = 'add-domain-btn';\n  addBtn.innerHTML = '+ Add';\n  addBtn.addEventListener('click', () => addNewDomain(index));\n  domainsArea.appendChild(addBtn);\n  \n  row.appendChild(procedureName);\n  row.appendChild(domainsArea);\n  \n  return row;\n}\n\n// Domain\nfunction createEditableDomainTag(domainText, mappingIndex, domainIndex) {\n  const tag = document.createElement('span');\n  tag.className = 'editable-domain-tag';\n  tag.textContent = domainText;\n  tag.dataset.mappingIndex = mappingIndex;\n  tag.dataset.domainIndex = domainIndex;\n  \n  // \n  const removeBtn = document.createElement('span');\n  removeBtn.className = 'remove-domain-btn';\n  removeBtn.innerHTML = '';\n  removeBtn.addEventListener('click', (e) => {\n    e.stopPropagation();\n    removeDomain(mappingIndex, domainIndex);\n  });\n  tag.appendChild(removeBtn);\n  \n  // \n  tag.addEventListener('click', () => {\n    if (isEditMode) {\n      makeTagEditable(tag);\n    }\n  });\n  \n  return tag;\n}\n\n// \nfunction makeTagEditable(tag) {\n  if (tag.contentEditable === 'true') return; // \n  \n  const originalText = tag.textContent.replace('', '').trim();\n  tag.innerHTML = originalText; // \n  tag.contentEditable = 'true';\n  tag.classList.add('editing');\n  tag.focus();\n  \n  // \n  const range = document.createRange();\n  range.selectNodeContents(tag);\n  const selection = window.getSelection();\n  selection.removeAllRanges();\n  selection.addRange(range);\n  \n  // \n  const finishEditing = () => {\n    tag.contentEditable = 'false';\n    tag.classList.remove('editing');\n    \n    const newText = tag.textContent.trim();\n    const mappingIndex = parseInt(tag.dataset.mappingIndex);\n    const domainIndex = parseInt(tag.dataset.domainIndex);\n    \n    // \n    if (newText && currentSDTMData.mappings[mappingIndex]) {\n      currentSDTMData.mappings[mappingIndex].sdtm_domains[domainIndex] = newText;\n    }\n    \n    // \n    const newTag = createEditableDomainTag(newText, mappingIndex, domainIndex);\n    tag.parentNode.replaceChild(newTag, tag);\n    \n    updateSummaryStats();\n  };\n  \n  // \n  tag.addEventListener('blur', finishEditing);\n  tag.addEventListener('keydown', (e) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      finishEditing();\n    } else if (e.key === 'Escape') {\n      e.preventDefault();\n      tag.textContent = originalText;\n      finishEditing();\n    }\n  });\n}\n\n// Domain\nfunction removeDomain(procedureIndex, domainIndex) {\n  const procedureName = currentSDTMData.procedures[procedureIndex];\n  if (!procedureName) return;\n  \n  // mapping\n  let mapping = currentSDTMData.mappings.find(m => m.procedure === procedureName);\n  if (mapping && mapping.sdtm_domains && mapping.sdtm_domains[domainIndex] !== undefined) {\n    // \n    mapping.sdtm_domains.splice(domainIndex, 1);\n    \n    // \n    displayFlatMappingsList(currentSDTMData);\n    \n    // \n    if (isEditMode) {\n      toggleEditMode();\n      toggleEditMode();\n    }\n    \n    updateSummaryStats();\n  }\n}\n\n// Domain\nfunction addNewDomain(procedureIndex) {\n  if (!isEditMode) return;\n  \n  const procedureName = currentSDTMData.procedures[procedureIndex];\n  if (!procedureName) return;\n  \n  // mapping\n  let mapping = currentSDTMData.mappings.find(m => m.procedure === procedureName);\n  if (!mapping) {\n    // mapping\n    mapping = {\n      procedure: procedureName,\n      sdtm_domains: []\n    };\n    currentSDTMData.mappings.push(mapping);\n  }\n  \n  // domain\n  mapping.sdtm_domains.push('');\n  const newDomainIndex = mapping.sdtm_domains.length - 1;\n  \n  // \n  displayFlatMappingsList(currentSDTMData);\n  \n  // \n  if (isEditMode) {\n    toggleEditMode();\n    toggleEditMode();\n  }\n  \n  // \n  setTimeout(() => {\n    const newTag = document.querySelector(`[data-mapping-index=\"${procedureIndex}\"][data-domain-index=\"${newDomainIndex}\"]`);\n    if (newTag) {\n      makeTagEditable(newTag);\n    }\n  }, 100);\n}\n\n// SDTM\nfunction setupSDTMEventListeners() {\n  // \n  const editBtn = document.getElementById('edit-mappings-btn');\n  if (editBtn) {\n    editBtn.addEventListener('click', toggleEditMode);\n  }\n  \n  // \n  const confirmBtn = document.getElementById('confirm-mappings-btn');\n  if (confirmBtn) {\n    confirmBtn.addEventListener('click', confirmSDTMAnalysis);\n  }\n}\n\n// \nfunction toggleEditMode() {\n  isEditMode = !isEditMode;\n  const editBtn = document.getElementById('edit-mappings-btn');\n  const flatMappingsList = document.getElementById('flat-mappings-list');\n  \n  if (editBtn) {\n    const btnLabel = editBtn.querySelector('.ms-Button-label');\n    btnLabel.textContent = isEditMode ? 'View Mode' : 'Edit';\n  }\n  \n  // \n  if (isEditMode) {\n    flatMappingsList.classList.add('edit-mode');\n    // \n    document.querySelectorAll('.mapping-row').forEach(row => {\n      row.classList.add('edit-mode');\n    });\n  } else {\n    flatMappingsList.classList.remove('edit-mode');\n    // \n    document.querySelectorAll('.mapping-row').forEach(row => {\n      row.classList.remove('edit-mode');\n    });\n  }\n}\n\n// \nfunction updateSummaryStats() {\n  // High \n  const domainToComplexity = new Map(); // domain -> 'High' | 'Medium'\n\n  if (Array.isArray(currentSDTMData.mappings)) {\n    currentSDTMData.mappings.forEach(mapping => {\n      const complexity = mapping && mapping.complexity === 'High' ? 'High' : 'Medium';\n      const domains = Array.isArray(mapping?.sdtm_domains) ? mapping.sdtm_domains : [];\n      domains.forEach(d => {\n        const domain = (d || '').trim();\n        if (!domain) return;\n        const existing = domainToComplexity.get(domain);\n        if (!existing) {\n          domainToComplexity.set(domain, complexity);\n        } else if (existing === 'Medium' && complexity === 'High') {\n          // High  Medium\n          domainToComplexity.set(domain, 'High');\n        }\n      });\n    });\n  }\n\n  const allDomains = Array.from(domainToComplexity.keys());\n  const highDomains = allDomains.filter(d => domainToComplexity.get(d) === 'High');\n  const mediumDomains = allDomains.filter(d => domainToComplexity.get(d) === 'Medium');\n\n  // summary -  procedures\n  currentSDTMData.summary.total_procedures = currentSDTMData.procedures ? currentSDTMData.procedures.length : 0;\n  currentSDTMData.summary.unique_domains = allDomains;\n  currentSDTMData.summary.total_sdtm_domains = allDomains.length;\n\n  // \n  currentSDTMData.summary.highComplexitySdtm = {\n    count: highDomains.length,\n    domains: highDomains\n  };\n  currentSDTMData.summary.mediumComplexitySdtm = {\n    count: mediumDomains.length,\n    domains: mediumDomains\n  };\n\n  // \n  updateSummaryAndDomainOverview(currentSDTMData.summary);\n\n  console.log(':', {\n    total_procedures: currentSDTMData.summary.total_procedures,\n    total_sdtm_domains: currentSDTMData.summary.total_sdtm_domains,\n    unique_domains: currentSDTMData.summary.unique_domains,\n    highComplexitySdtm: currentSDTMData.summary.highComplexitySdtm,\n    mediumComplexitySdtm: currentSDTMData.summary.mediumComplexitySdtm\n  });\n}\n\n// SDTM\nasync function confirmSDTMAnalysis() {\n  if (!window.currentDocumentId) {\n    alert('No document ID found. Please re-upload the document.');\n    return;\n  }\n  if (!currentSDTMData || !Array.isArray(currentSDTMData.procedures)) {\n    showStatusMessage('No SDTM data to confirm.', 'error');\n    return;\n  }\n  \n  try {\n    console.log('...');\n    \n    const response = await fetch(`${API_BASE_URL}/api/documents/${window.currentDocumentId}/confirm-sdtm`, {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        procedures: currentSDTMData.procedures || [],\n        mappings: currentSDTMData.mappings || [],\n        summary: currentSDTMData.summary || {}\n      })\n    });\n    \n    const result = await response.json();\n    \n    if (result.success) {\n      console.log('SDTM');\n      \n      // \n      const confirmationStatus = document.getElementById('confirmation-status');\n      if (confirmationStatus) {\n        confirmationStatus.style.display = 'flex';\n      }\n      \n      // \n      const editBtn = document.getElementById('edit-mappings-btn');\n      const confirmBtn = document.getElementById('confirm-mappings-btn');\n      if (editBtn) editBtn.style.display = 'none';\n      if (confirmBtn) confirmBtn.style.display = 'none';\n      \n      showStatusMessage('SDTM analysis confirmed and saved successfully!', 'success');\n\n      //  Excel Unit  Estimated cost\n      const costEstimate = result?.data?.costEstimate;\n      let sdtmDataForNotes = null;\n      if (costEstimate && costEstimate['SDTM Datasets Production and Validation']) {\n        await applySDTMUnitsAndCostsToExcel(costEstimate['SDTM Datasets Production and Validation']);\n      }\n\n      //  Notes \n      try {\n        const docResp = await fetch(`${API_BASE_URL}/api/documents/${window.currentDocumentId}/content`);\n        if (docResp.ok) {\n          const docData = await docResp.json();\n          const snapshot = docData?.document?.costEstimate?.['SDTM Datasets Production and Validation'];\n          if (!costEstimate && snapshot) {\n            await applySDTMUnitsAndCostsToExcel(snapshot);\n          }\n          const sdtmData = docData?.document?.sdtmData;\n          if (sdtmData) {\n            const hasValidConfirmed = !!(sdtmData.confirmed && sdtmData.confirmed.summary && (\n              (typeof sdtmData.confirmed.summary.total_sdtm_domains === 'number' && sdtmData.confirmed.summary.total_sdtm_domains > 0) ||\n              (Array.isArray(sdtmData.confirmed.summary.unique_domains) && sdtmData.confirmed.summary.unique_domains.length > 0)\n            ));\n            sdtmDataForNotes = hasValidConfirmed ? sdtmData.confirmed : sdtmData.original;\n          }\n        }\n      } catch (e) {\n        console.warn('Notes:', e);\n      }\n\n      if (sdtmDataForNotes) {\n        await applySDTMNotesToExcel(sdtmDataForNotes);\n      }\n\n    } else {\n      console.error(':', result.message);\n      showStatusMessage('Failed to confirm SDTM analysis: ' + result.message, 'error');\n    }\n    \n  } catch (error) {\n    console.error(':', error);\n    showStatusMessage('Network error: Failed to confirm SDTM analysis', 'error');\n  }\n}\n\n//  SDTM units  estimatedCosts Excel\nasync function applySDTMUnitsAndCostsToExcel(snapshot) {\n  const taskToKey = {\n    'SDTM Annotated CRFs (aCRF)': 'annotatedCrf',\n    'SDTM Dataset Specs (High Complexity)': 'specsHigh',\n    'SDTM Dataset Specs (Medium Complexity)': 'specsMedium',\n    'SDTM Production and Validation: Programs and Datasets (High Complexity)': 'prodHigh',\n    'SDTM Production and Validation: Programs and Datasets (Medium Complexity)': 'prodMedium',\n    'SDTM Pinnacle 21 Report Creation and Review': 'pinnacle21',\n    \"SDTM Reviewer's Guide\": 'reviewersGuide',\n    'SDTM Define.xml': 'defineXml',\n    'SDTM Dataset File xpt Conversion and Review': 'xptConversion'\n  };\n\n  try {\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\n      const used = sheet.getUsedRange();\n      used.load(['values', 'rowIndex', 'columnIndex']);\n      await context.sync();\n\n      const startRow = used.rowIndex || 0;\n      const startCol = used.columnIndex || 0;\n      const rows = used.values;\n      const units = snapshot.units || {};\n      const costs = snapshot.estimatedCosts || {};\n      const subtotal = snapshot.subtotal ?? null;\n\n      //  Unit/F\n      for (let r = 0; r < rows.length; r++) {\n        const task = String(rows[r][0] || '').trim();\n        if (!taskToKey.hasOwnProperty(task)) continue;\n        const key = taskToKey[task];\n        const unitVal = units[key] ?? '';\n        const costVal = costs[key] ?? '';\n\n        const unitCell = sheet.getRangeByIndexes(startRow + r, startCol + 1, 1, 1); // B\n        const estCostCell = sheet.getRangeByIndexes(startRow + r, startCol + 5, 1, 1); // F\n        unitCell.values = [[unitVal === '' ? '' : Number(unitVal)]];\n        unitCell.format.horizontalAlignment = 'Right';\n        estCostCell.values = [[costVal === '' ? '' : `$${Number(costVal)}`]];\n        estCostCell.format.horizontalAlignment = 'Right';\n      }\n\n      // SDTMSubtotal\n      if (subtotal !== null) {\n        // SDTM\n        let sdtmStartRow = -1;\n        for (let r = 0; r < rows.length; r++) {\n          const task = String(rows[r][0] || '').trim();\n          if (task.toLowerCase() === 'sdtm datasets production and validation') {\n            sdtmStartRow = r;\n            break;\n          }\n        }\n        if (sdtmStartRow >= 0) {\n          //  'Subtotal' \n          for (let r = sdtmStartRow + 1; r < rows.length; r++) {\n            const firstCell = String(rows[r][0] || '').trim();\n            if (firstCell.toLowerCase() === 'subtotal') {\n              const subtotalCell = sheet.getRangeByIndexes(startRow + r, startCol + 5, 1, 1); // F\n              subtotalCell.values = [[`$${Number(subtotal)}`]];\n              subtotalCell.format.horizontalAlignment = 'Right';\n              break;\n            }\n          }\n        }\n      }\n\n      await context.sync();\n      showStatusMessage('Units, estimated costs and subtotal applied from confirmed SDTM data.', 'success');\n    });\n  } catch (err) {\n    console.error('ExcelSDTM:', err);\n    showStatusMessage('Failed to write units/costs/subtotal to Excel: ' + err.message, 'error');\n  }\n}\n\n//   SDTM Notes\nasync function applySDTMNotesToExcel(sdtmInfo) {\n  try {\n    const highDomains = sdtmInfo?.summary?.highComplexitySdtm?.domains || [];\n    const mediumDomains = sdtmInfo?.summary?.mediumComplexitySdtm?.domains || [];\n    const allDomains = sdtmInfo?.summary?.unique_domains || [];\n\n    const notesMap = {\n      'SDTM Dataset Specs (High Complexity)': highDomains.join('/'),\n      'SDTM Dataset Specs (Medium Complexity)': mediumDomains.join('/'),\n      'SDTM Dataset File xpt Conversion and Review': allDomains.join('/'),\n    };\n\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\n      const used = sheet.getUsedRange();\n      used.load(['values', 'rowIndex', 'columnIndex']);\n      await context.sync();\n\n      const startRow = used.rowIndex || 0;\n      const startCol = used.columnIndex || 0;\n      const rows = used.values;\n\n      for (let r = 0; r < rows.length; r++) {\n        const task = String(rows[r][0] || '').trim();\n        if (!(task in notesMap)) continue;\n        const note = notesMap[task] || '';\n        const noteCell = sheet.getRangeByIndexes(startRow + r, startCol + 6, 1, 1); // G Notes\n        noteCell.values = [[note]];\n        noteCell.format.horizontalAlignment = 'Left';\n      }\n\n      await context.sync();\n      showStatusMessage('Notes updated from SDTM confirmed data.', 'success');\n    });\n  } catch (err) {\n    console.error('SDTM Notes:', err);\n    showStatusMessage('Failed to write SDTM notes: ' + err.message, 'error');\n  }\n}\n\n// SDTM\nfunction hideSDTMAnalysis() {\n  const sdtmSection = document.getElementById('sdtm-analysis-section');\n  const sdtmMappingsContainer = document.getElementById('sdtm-mappings-container');\n  \n  if (sdtmSection) {\n    sdtmSection.style.display = 'none';\n  }\n  \n  if (sdtmMappingsContainer) {\n    sdtmMappingsContainer.style.display = 'none';\n  }\n  \n  // \n  currentSDTMData = null;\n  window.currentDocumentId = null;\n  isEditMode = false;\n  selectedProcedureIndex = 0;\n}\n\n// Excel\nasync function saveExcelToLocal() {\n  try {\n    await Excel.run(async (context) => {\n      const workbook = context.workbook;\n      \n      // \n      const now = new Date();\n      const timestamp = now.toISOString().replace(/[:.]/g, '-').slice(0, 19);\n      const fileName = `LLX_Cost_Analysis_${timestamp}.xlsx`;\n      \n      // \n      workbook.save();\n      await context.sync();\n      \n      console.log(' Excel:', fileName);\n      showStatusMessage('Excel file saved successfully!', 'success');\n    });\n  } catch (error) {\n    console.error(' Excel:', error);\n    showStatusMessage('Failed to save Excel: ' + error.message, 'error');\n  }\n}\n\n// Excel\nasync function clearExcelContent() {\n  try {\n    await Excel.run(async (context) => {\n      const worksheet = context.workbook.worksheets.getActiveWorksheet();\n      \n      // \n      const usedRange = worksheet.getUsedRange();\n      if (usedRange) {\n        usedRange.clear();\n        await context.sync();\n      }\n      \n      console.log(' Excel');\n      showStatusMessage('Excel content cleared for new project!', 'success');\n    });\n  } catch (error) {\n    console.error(' Excel:', error);\n    showStatusMessage('Failed to clear Excel: ' + error.message, 'error');\n  }\n}\n\n// \nasync function resetToStart() {\n  try {\n    // \n    uploadedProtocol = null;\n    window.currentDocumentId = null;\n    currentSDTMData = null;\n    isEditMode = false;\n    selectedProcedureIndex = 0;\n    \n    // Excel\n    await clearDocumentIdFromSettings();\n    \n    // \n    const checkboxes = document.querySelectorAll('.project-options input[type=\"checkbox\"]');\n    checkboxes.forEach(checkbox => {\n      checkbox.checked = false;\n      const dataAttr = checkbox.getAttribute('data-requires-count');\n      if (dataAttr) {\n        const container = document.getElementById(`${dataAttr}-container`);\n        const input = document.getElementById(`${dataAttr}-count`);\n        if (container) container.style.display = 'none';\n        if (input) input.value = '';\n      }\n    });\n    \n    // \n    document.getElementById('protocol-upload-area').style.display = 'block';\n    document.getElementById('protocol-progress').style.display = 'none';\n    document.getElementById('protocol-result').style.display = 'none';\n    document.getElementById('protocol-file-input').value = '';\n    \n    // SDTM\n    hideSDTMAnalysis();\n    \n    // 1\n    showStep(1);\n    \n    console.log(' ');\n    showStatusMessage('Ready for new project!', 'success');\n    \n  } catch (error) {\n    console.error(' :', error);\n    showStatusMessage('Failed to reset: ' + error.message, 'error');\n  }\n}\n\n//  \nasync function createStandardCostAnalysisHeaders() {\n  try {\n    await Excel.run(async (context) => {\n      // \n      const worksheet = context.workbook.worksheets.getActiveWorksheet();\n      \n      // \n      const headers = [\n        \"Task\",\n        \"Unit\", \n        \"Cost Per Hour\",\n        \"# of Hours Per Unit\",\n        \"Cost Per Unit\",\n        \"Estimated cost\",\n        \"Notes\"\n      ];\n      \n      // A1:G1\n      const headerRange = worksheet.getRange(\"A1:G1\");\n      \n      // \n      headerRange.values = [headers];\n      \n      // \n      headerRange.format.font.bold = true;\n      \n      // \n      headerRange.format.font.size = 12;\n      headerRange.format.fill.color = \"#E7E7E7\"; // \n      headerRange.format.borders.getItem(\"EdgeTop\").style = \"Continuous\";\n      headerRange.format.borders.getItem(\"EdgeBottom\").style = \"Continuous\";\n      headerRange.format.borders.getItem(\"EdgeLeft\").style = \"Continuous\";\n      headerRange.format.borders.getItem(\"EdgeRight\").style = \"Continuous\";\n      headerRange.format.borders.getItem(\"InsideVertical\").style = \"Continuous\";\n      \n      // \n      headerRange.format.autofitColumns();\n\n      await context.sync();\n      \n      console.log(' ');\n      showStatusMessage('Excel table headers created successfully!', 'success');\n    });\n  } catch (error) {\n    console.error(' Excel:', error);\n    showStatusMessage('Failed to create Excel headers: ' + error.message, 'error');\n  }\n}\n\n//  ExcelUnit/Estimated cost\nasync function populateExcelWithSelectedProjects() {\n  try {\n    // MongoDBSDTM\n    let savedProjectDetails = {};\n    let sdtmInfo = null;\n    if (window.currentDocumentId) {\n      try {\n        const response = await fetch(`${API_BASE_URL}/api/documents/${window.currentDocumentId}/content`);\n        if (response.ok) {\n          const docData = await response.json();\n          if (docData.document && docData.document.projectSelectionDetails) {\n            savedProjectDetails = docData.document.projectSelectionDetails;\n          }\n          // SDTMUnit\n          if (docData.document && docData.document.sdtmData) {\n            const sdtmData = docData.document.sdtmData;\n            const hasValidConfirmed = !!(sdtmData.confirmed && sdtmData.confirmed.summary && (\n              (typeof sdtmData.confirmed.summary.total_sdtm_domains === 'number' && sdtmData.confirmed.summary.total_sdtm_domains > 0) ||\n              (Array.isArray(sdtmData.confirmed.summary.unique_domains) && sdtmData.confirmed.summary.unique_domains.length > 0)\n            ));\n            sdtmInfo = hasValidConfirmed ? sdtmData.confirmed : sdtmData.original;\n          }\n        }\n      } catch (error) {\n        console.warn(':', error);\n      }\n    }\n    \n    if (Object.keys(savedProjectDetails).length === 0) {\n      const { projectSelectionDetails } = collectProjectSelectionDetails();\n      savedProjectDetails = projectSelectionDetails;\n    }\n\n    const highComplexityCount = sdtmInfo?.summary?.highComplexitySdtm?.count || 0;\n    const mediumComplexityCount = sdtmInfo?.summary?.mediumComplexitySdtm?.count || 0;\n    const totalDomainsCount = sdtmInfo?.summary?.total_sdtm_domains || 0;\n\n    await Excel.run(async (context) => {\n      const worksheet = context.workbook.worksheets.getActiveWorksheet();\n      let currentRow = 2;\n\n      if (Object.keys(savedProjectDetails).length > 0) {\n        for (const [projectName, count] of Object.entries(savedProjectDetails)) {\n          if (projectName === 'lastUpdated') continue;\n\n          const isSDTM = projectName.toLowerCase().includes(\"sdtm\");\n          const isADAM = projectName.toLowerCase().includes(\"adam\");\n          const isDSUR = projectName.toLowerCase().includes(\"dsur\");\n          const isDSMB = projectName.toLowerCase().includes(\"dsmb\");\n          const isStatisticalAnalysisPlan = projectName.toLowerCase().includes(\"statistical analysis plan\");\n\n          if (isSDTM || isADAM || isStatisticalAnalysisPlan) {\n            const projectNameRange = worksheet.getRange(`A${currentRow}:G${currentRow}`);\n            projectNameRange.values = [[projectName, \"\", \"\", \"\", \"\", \"\", \"\"]];\n            projectNameRange.format.font.bold = true;\n            projectNameRange.format.horizontalAlignment = \"Left\";\n            currentRow++;\n\n            if (isSDTM) {\n              const sdtmSubItems = [\n                { name: \"SDTM Annotated CRFs (aCRF)\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 32, costPerUnit: 32.0 },\n                { name: \"SDTM Dataset Specs (High Complexity)\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 3, costPerUnit: 3.0 },\n                { name: \"SDTM Dataset Specs (Medium Complexity)\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 2, costPerUnit: 2.0 },\n                { name: \"SDTM Production and Validation: Programs and Datasets (High Complexity)\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 16, costPerUnit: 16.0 },\n                { name: \"SDTM Production and Validation: Programs and Datasets (Medium Complexity)\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 10, costPerUnit: 10.0 },\n                { name: \"SDTM Pinnacle 21 Report Creation and Review\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 6, costPerUnit: 6.0 },\n                { name: \"SDTM Reviewer's Guide\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 32, costPerUnit: 32.0 },\n                { name: \"SDTM Define.xml\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 32, costPerUnit: 32.0 },\n                { name: \"SDTM Dataset File xpt Conversion and Review\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 0.2, costPerUnit: 0.2 }\n              ];\n\n              for (const subItem of sdtmSubItems) {\n                const subItemRange = worksheet.getRange(`A${currentRow}:G${currentRow}`);\n                subItemRange.values = [[\n                  subItem.name,\n                  \"\", // Unit \n                  `$${subItem.costPerHour}`,\n                  subItem.hoursPerUnit,\n                  `$${subItem.costPerUnit}`,\n                  \"\", // Estimated Cost \n                  \"\"\n                ]];\n                \n                // Estimated Cost(F)Excel=B*C*D\n                const estimatedCostCell = worksheet.getRange(`F${currentRow}`);\n                estimatedCostCell.formulas = [[`=B${currentRow}*C${currentRow}*D${currentRow}`]];\n                estimatedCostCell.format.numberFormat = [[\"$#,##0.00\"]];\n                \n                subItemRange.format.font.bold = false;\n                subItemRange.format.horizontalAlignment = \"Left\";\n                const numberColumns = worksheet.getRange(`B${currentRow}:F${currentRow}`);\n                numberColumns.format.horizontalAlignment = \"Right\";\n                currentRow++;\n              }\n            } else if (isADAM) {\n              // ADAM Unit \n              const adamSubItems = [\n                { name: \"ADaM Dataset Specs (High Complexity)\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 3, costPerUnit: 3.0 },\n                { name: \"ADaM Dataset Specs (Medium Complexity)\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 2, costPerUnit: 2.0 },\n                { name: \"ADaM Production and Validation: Programs and Datasets (High Complexity)\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 18, costPerUnit: 18.0 },\n                { name: \"ADaM Production and Validation: Programs and Datasets (Medium Complexity)\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 10, costPerUnit: 10.0 },\n                { name: \"ADaM Pinnacle 21 Report Creation and Review\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 4, costPerUnit: 4.0 },\n                { name: \"ADaM Reviewer's Guide\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 32, costPerUnit: 32.0 },\n                { name: \"ADaM Define.xml\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 32, costPerUnit: 32.0 },\n                { name: \"ADaM Dataset Program xpt Conversion and Review\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 0.2, costPerUnit: 0.2 },\n                { name: \"ADaM Program txt Conversion and Review\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 0.2, costPerUnit: 0.2 }\n              ];\n\n              for (const subItem of adamSubItems) {\n                const subItemRange = worksheet.getRange(`A${currentRow}:G${currentRow}`);\n                subItemRange.values = [[\n                  subItem.name,\n                  \"\",\n                  `$${subItem.costPerHour}`,\n                  subItem.hoursPerUnit,\n                  `$${subItem.costPerUnit}`,\n                  \"\",\n                  \"\"\n                ]];\n                \n                // Estimated Cost(F)Excel=B*C*D\n                const estimatedCostCell = worksheet.getRange(`F${currentRow}`);\n                estimatedCostCell.formulas = [[`=B${currentRow}*C${currentRow}*D${currentRow}`]];\n                estimatedCostCell.format.numberFormat = [[\"$#,##0.00\"]];\n                \n                subItemRange.format.font.bold = false;\n                subItemRange.format.horizontalAlignment = \"Left\";\n                const numberColumns = worksheet.getRange(`B${currentRow}:F${currentRow}`);\n                numberColumns.format.horizontalAlignment = \"Right\";\n                currentRow++;\n              }\n            } else if (isStatisticalAnalysisPlan) {\n              const sapSubItems = [\n                { name: \"Statistical Analysis Plan Draft 1\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 40, costPerUnit: 40.0 },\n                { name: \"Statistical Analysis Plan Draft 2\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 30, costPerUnit: 30.0 },\n                { name: \"Statistical Analysis Plan Final\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 20, costPerUnit: 20.0 },\n                { name: \"Analysis Shells Development\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 60, costPerUnit: 60.0 },\n                { name: \"Mock Tables, Listings, and Figures\", unit: \"\", costPerHour: 1.0, hoursPerUnit: 40, costPerUnit: 40.0 }\n              ];\n              for (const subItem of sapSubItems) {\n                const subItemRange = worksheet.getRange(`A${currentRow}:G${currentRow}`);\n                subItemRange.values = [[subItem.name, \"\", `$${subItem.costPerHour}`, subItem.hoursPerUnit, `$${subItem.costPerUnit}`, \"\", \"\"]];\n                \n                // Estimated Cost(F)Excel=B*C*D\n                const estimatedCostCell = worksheet.getRange(`F${currentRow}`);\n                estimatedCostCell.formulas = [[`=B${currentRow}*C${currentRow}*D${currentRow}`]];\n                estimatedCostCell.format.numberFormat = [[\"$#,##0.00\"]];\n                \n                subItemRange.format.font.bold = false;\n                subItemRange.format.horizontalAlignment = \"Left\";\n                const numberColumns = worksheet.getRange(`B${currentRow}:F${currentRow}`);\n                numberColumns.format.horizontalAlignment = \"Right\";\n                currentRow++;\n              }\n            }\n\n            // Subtotal for main section with Excel SUM formula\n            const mainSubtotalRange = worksheet.getRange(`A${currentRow}:G${currentRow}`);\n            mainSubtotalRange.values = [[\"Subtotal\", \"\", \"\", \"\", \"\", \"\", \"\"]];\n            \n            // +1-1\n            let sectionStartRow = currentRow - (isSDTM ? 9 : isADAM ? 9 : isStatisticalAnalysisPlan ? 5 : 1);\n            let sectionEndRow = currentRow - 1;\n            \n            // SubtotalFSUM\n            const subtotalCell = worksheet.getRange(`F${currentRow}`);\n            subtotalCell.formulas = [[`=SUM(F${sectionStartRow}:F${sectionEndRow})`]];\n            subtotalCell.format.numberFormat = [[\"$#,##0.00\"]];\n            subtotalCell.format.font.bold = true;\n            \n            mainSubtotalRange.format.font.bold = true;\n            mainSubtotalRange.format.horizontalAlignment = \"Right\";\n            currentRow++;\n\n            // Transfer blocks remain unchanged\n            if (count && count > 0 && (isSDTM || isADAM)) {\n              const transferSubsection = isSDTM ? `SDTM Dataset Transfer (${count} times)` : `ADAM Dataset Transfer (${count} times)`;\n              const transferRange = worksheet.getRange(`A${currentRow}:G${currentRow}`);\n              transferRange.values = [[transferSubsection, \"\", \"\", \"\", \"\", \"\", \"\"]];\n              transferRange.format.font.bold = true;\n              transferRange.format.horizontalAlignment = \"Left\";\n              currentRow++;\n\n              const transferSubItems = isSDTM ? [\n                { name: `Production and Validation, the first 2 times`, unit: 2, costPerHour: 1.0, hoursPerUnit: 25, costPerUnit: 25.0 },\n                { name: `Production and Validation, the last ${count - 2} times`, unit: count - 2, costPerHour: 1.0, hoursPerUnit: 12.5, costPerUnit: 12.5 }\n              ] : [\n                { name: `Production and Validation, the first 2 times`, unit: 2, costPerHour: 1.0, hoursPerUnit: 15, costPerUnit: 15.0 },\n                { name: `Production and Validation, the last ${count - 2} times`, unit: count - 2, costPerHour: 1.0, hoursPerUnit: 7.5, costPerUnit: 7.5 }\n              ];\n              for (const transferSubItem of transferSubItems) {\n                const transferSubItemRange = worksheet.getRange(`A${currentRow}:G${currentRow}`);\n                transferSubItemRange.values = [[transferSubItem.name, \"\", `$${transferSubItem.costPerHour}`, transferSubItem.hoursPerUnit, `$${transferSubItem.costPerUnit}`, \"\", \"\"]];\n                transferSubItemRange.format.font.bold = false;\n                transferSubItemRange.format.horizontalAlignment = \"Left\";\n                const transferNumberColumns = worksheet.getRange(`B${currentRow}:F${currentRow}`);\n                transferNumberColumns.format.horizontalAlignment = \"Right\";\n                currentRow++;\n              }\n              const transferSubtotalRange = worksheet.getRange(`A${currentRow}:G${currentRow}`);\n              transferSubtotalRange.values = [[\"Subtotal\", \"\", \"\", \"\", \"\", \"\", \"\"]];\n              transferSubtotalRange.format.font.bold = true;\n              transferSubtotalRange.format.horizontalAlignment = \"Right\";\n              currentRow++;\n            }\n\n          } else if (isDSUR || isDSMB) {\n            if (count && count > 0) {\n              const rerunSubsection = isDSUR ? `DSUR Rerun (${count} times)` : `DSMB Rerun (${count} times)`;\n              const rerunRange = worksheet.getRange(`A${currentRow}:G${currentRow}`);\n              rerunRange.values = [[rerunSubsection, \"\", \"\", \"\", \"\", \"\", \"\"]];\n              rerunRange.format.font.bold = true;\n              rerunRange.format.horizontalAlignment = \"Left\";\n              currentRow++;\n              const rerunSubtotalRange = worksheet.getRange(`A${currentRow}:G${currentRow}`);\n              rerunSubtotalRange.values = [[\"Subtotal\", \"\", \"\", \"\", \"\", \"\", \"\"]];\n              rerunSubtotalRange.format.font.bold = true;\n              rerunSubtotalRange.format.horizontalAlignment = \"Right\";\n              currentRow++;\n            }\n          } else {\n            const projectNameRange = worksheet.getRange(`A${currentRow}:G${currentRow}`);\n            projectNameRange.values = [[projectName, \"\", \"\", \"\", \"\", \"\", \"\"]];\n            projectNameRange.format.font.bold = true;\n            projectNameRange.format.horizontalAlignment = \"Left\";\n            currentRow++;\n            const subtotalRange = worksheet.getRange(`A${currentRow}:G${currentRow}`);\n            subtotalRange.values = [[\"Subtotal\", \"\", \"\", \"\", \"\", \"\", \"\"]];\n            subtotalRange.format.font.bold = true;\n            subtotalRange.format.horizontalAlignment = \"Right\";\n            currentRow++;\n          }\n        }\n      }\n\n      // \n      const defaultSections = [\n        'License Fees',\n        'Adhoc Analysis',\n        'Project Management/Administration(12 Months)'\n      ];\n      for (const sectionName of defaultSections) {\n        const range = worksheet.getRange(`A${currentRow}:G${currentRow}`);\n        range.values = [[sectionName, \"\", \"\", \"\", \"\", \"\", \"\"]];\n        range.format.font.bold = true;\n        range.format.horizontalAlignment = 'Left';\n        currentRow++;\n        const subtotalRange = worksheet.getRange(`A${currentRow}:G${currentRow}`);\n        subtotalRange.values = [[\"Subtotal\", \"\", \"\", \"\", \"\", \"\", \"\"]];\n        subtotalRange.format.font.bold = true;\n        subtotalRange.format.horizontalAlignment = 'Right';\n        currentRow++;\n      }\n\n      // Grand Total\n      const grandTotalRange = worksheet.getRange(`A${currentRow}:G${currentRow}`);\n      grandTotalRange.values = [[\"Grand Total\", \"\", \"\", \"\", \"\", \"\", \"\"]];\n      grandTotalRange.format.font.bold = true;\n      grandTotalRange.format.horizontalAlignment = 'Right';\n    });\n  } catch (error) {\n    console.error('Excel:', error);\n    showStatusMessage('Failed to populate Excel: ' + error.message, 'error');\n  }\n}\n\n//  \nfunction initProjectSelectionLogic() {\n  // checkbox\n  const checkboxesWithCounts = document.querySelectorAll('[data-requires-count]');\n  \n  checkboxesWithCounts.forEach(checkbox => {\n    checkbox.addEventListener('change', function() {\n      const countType = this.getAttribute('data-requires-count');\n      const container = document.getElementById(`${countType}-container`);\n      \n      if (container) {\n        if (this.checked) {\n          // \n          container.style.display = 'flex';\n          // \n          const input = container.querySelector('.count-input');\n          if (input) {\n            setTimeout(() => input.focus(), 300);\n          }\n        } else {\n          // \n          container.style.display = 'none';\n          const input = container.querySelector('.count-input');\n          if (input) {\n            input.value = '';\n          }\n        }\n      }\n    });\n  });\n}\n\n//   (: ->)\nfunction collectProjectSelectionDetails() {\n  const projectSelectionDetails = {};\n  \n  // \n  const allCheckboxes = document.querySelectorAll('.ms-CheckBox-input');\n  allCheckboxes.forEach((checkbox) => {\n    if (checkbox.checked) {\n      const projectName = checkbox.parentElement.querySelector('.ms-CheckBox-text').textContent.trim();\n      \n      // \n      let count = null;\n      const requiresCount = checkbox.getAttribute('data-requires-count');\n      \n      if (requiresCount) {\n        const countInput = document.getElementById(`${requiresCount}-count`);\n        if (countInput && countInput.value) {\n          count = parseInt(countInput.value);\n        }\n      }\n      \n      // : \"\":  (null)\n      projectSelectionDetails[projectName] = count;\n    }\n  });\n  \n  return {\n    projectSelectionDetails\n  };\n}\n\n//  \nasync function saveProjectSelectionDetails() {\n  try {\n    if (!window.currentDocumentId) {\n      console.warn('ID');\n      return;\n    }\n    \n    const { projectSelectionDetails } = collectProjectSelectionDetails();\n    \n    // \n    if (Object.keys(projectSelectionDetails).length === 0) {\n      console.log('');\n      return;\n    }\n    \n    const response = await fetch(`${API_BASE_URL}/api/documents/${window.currentDocumentId}/project-selection`, {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({ projectSelectionDetails })\n    });\n    \n    if (response.ok) {\n      console.log(' ');\n      showStatusMessage('Project selection automatically saved with document!', 'success');\n    } else {\n      throw new Error('');\n    }\n    \n  } catch (error) {\n    console.error(' :', error);\n    // \n  }\n}\n\n\n\n\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>LLXSolutions</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <section id=\\\"sideload-msg\\\" class=\\\"ms-welcome__main\\\"> <h2 class=\\\"ms-font-xl\\\">Please <a target=\\\"_blank\\\" href=\\\"https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing\\\">sideload</a> your add-in to see app body.</h2> </section> <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\" style=\\\"display:none\\\"> <div class=\\\"wizard-page\\\" data-step=\\\"1\\\" style=\\\"display:none\\\"> <h3 class=\\\"ms-font-l\\\"> AI Assistant</h3> <div class=\\\"chat-container\\\" id=\\\"chat-container\\\"> <div class=\\\"chat-messages\\\" id=\\\"chat-messages\\\"> <div class=\\\"message ai-message\\\"> <div class=\\\"message-content\\\"> Hello! What would you like to do today? <br><br>You can say something like: <br> \\\"I want to do Phase II study cost analysis for study SK123-kbi\\\" <br> \\\"Help me estimate costs for an oncology trial (study number: ABC-123)\\\" <br> \\\"I need SDTM mapping for study SK123-kbi protocol\\\" </div> </div> </div> <div class=\\\"chat-input-area\\\"> <div class=\\\"input-group\\\"> <input type=\\\"text\\\" id=\\\"chat-input\\\" class=\\\"chat-input\\\" placeholder=\\\"e.g. I want to do Phase II study cost analysis for study SK123-kbi\\\" maxlength=\\\"500\\\"> <button id=\\\"chat-send-btn\\\" class=\\\"chat-send-btn\\\"> <span class=\\\"ms-Icon ms-Icon--Send\\\"></span> </button> </div> </div> </div> </div> <div class=\\\"upload-section wizard-page\\\" data-step=\\\"3\\\"> <h3 class=\\\"ms-font-l\\\"> Protocol Upload</h3> <div class=\\\"upload-area\\\" id=\\\"protocol-upload-area\\\"> <div class=\\\"upload-content\\\"> <i class=\\\"ms-Icon ms-Icon--CloudUpload ms-font-xxl upload-icon\\\"></i> <h4 class=\\\"ms-font-l\\\">Upload Protocol Document</h4> <p class=\\\"ms-font-m\\\">Support PDF and Word documents</p> <div class=\\\"ms-Button ms-Button--primary\\\" id=\\\"protocol-select-btn\\\"> <span class=\\\"ms-Button-label\\\">Select File</span> </div> <input type=\\\"file\\\" id=\\\"protocol-file-input\\\" accept=\\\".pdf,.doc,.docx\\\" style=\\\"display:none\\\"> </div> </div> <div class=\\\"upload-progress\\\" id=\\\"protocol-progress\\\" style=\\\"display:none\\\"> <div class=\\\"ms-Spinner\\\"> <div class=\\\"ms-Spinner-circle ms-Spinner-circle--large\\\"></div> </div> <p class=\\\"ms-font-m\\\" id=\\\"protocol-progress-text\\\">Uploading protocol...</p> <div class=\\\"ms-Button\\\" id=\\\"protocol-cancel-btn\\\"> <span class=\\\"ms-Button-label\\\">Cancel Upload</span> </div> </div> <div class=\\\"upload-result\\\" id=\\\"protocol-result\\\" style=\\\"display:none\\\"> <div class=\\\"file-info\\\"> <i class=\\\"ms-Icon ms-Icon--Document ms-font-l file-icon\\\"></i> <div class=\\\"file-details\\\"> <span class=\\\"file-name\\\" id=\\\"protocol-file-name\\\">filename.pdf</span> <span class=\\\"file-status\\\" id=\\\"protocol-file-status\\\"> Uploaded successfully</span> </div> <div class=\\\"file-actions\\\"> <div class=\\\"ms-Button ms-Button--small\\\" id=\\\"protocol-remove-btn\\\"> <span class=\\\"ms-Button-label\\\"> Remove</span> </div> </div> </div> </div> </div> <div class=\\\"wizard-page\\\" data-step=\\\"4\\\" style=\\\"display:none\\\"> <h3 class=\\\"ms-font-l\\\"> Analyzing Protocol...</h3> <p class=\\\"ms-font-s\\\">We are running SDTM analysis based on your uploaded protocol. Please wait.</p> <div class=\\\"ms-Spinner\\\"> <div class=\\\"ms-Spinner-circle ms-Spinner-circle--large\\\"></div> </div> </div> <div class=\\\"project-selection-section wizard-page\\\" data-step=\\\"5\\\" style=\\\"display:none\\\"> <h3 class=\\\"ms-font-l\\\"> Project Selection</h3> <p class=\\\"ms-font-s\\\">Please select the services you need (multiple selection allowed):</p> <div class=\\\"project-options\\\"> <div class=\\\"project-option\\\"> <input type=\\\"checkbox\\\" id=\\\"project-1\\\" class=\\\"ms-CheckBox-input\\\"/> <label for=\\\"project-1\\\" class=\\\"ms-CheckBox-label\\\"> <span class=\\\"ms-CheckBox-field\\\"></span> <span class=\\\"ms-CheckBox-text\\\">Statistical Analysis Plan and Shells Development (2 Drafts and 1 Final)</span> </label> </div> <div class=\\\"project-option\\\"> <input type=\\\"checkbox\\\" id=\\\"project-2\\\" class=\\\"ms-CheckBox-input\\\" data-requires-count=\\\"sdtm-transfer\\\"/> <label for=\\\"project-2\\\" class=\\\"ms-CheckBox-label\\\"> <span class=\\\"ms-CheckBox-field\\\"></span> <span class=\\\"ms-CheckBox-text\\\">SDTM Datasets Production and Validation</span> </label> <div class=\\\"count-input-container\\\" id=\\\"sdtm-transfer-container\\\" style=\\\"display:none\\\"> <label class=\\\"count-label\\\">Data Transfer Times:</label> <input type=\\\"number\\\" id=\\\"sdtm-transfer-count\\\" class=\\\"count-input ms-TextField-field\\\" min=\\\"1\\\" max=\\\"999\\\" placeholder=\\\"e.g. 5\\\"/> <span class=\\\"count-suffix\\\">times</span> </div> </div> <div class=\\\"project-option\\\"> <input type=\\\"checkbox\\\" id=\\\"project-3\\\" class=\\\"ms-CheckBox-input\\\" data-requires-count=\\\"adam-transfer\\\"/> <label for=\\\"project-3\\\" class=\\\"ms-CheckBox-label\\\"> <span class=\\\"ms-CheckBox-field\\\"></span> <span class=\\\"ms-CheckBox-text\\\">ADaM Datasets Production and Validation</span> </label> <div class=\\\"count-input-container\\\" id=\\\"adam-transfer-container\\\" style=\\\"display:none\\\"> <label class=\\\"count-label\\\">Data Transfer Times:</label> <input type=\\\"number\\\" id=\\\"adam-transfer-count\\\" class=\\\"count-input ms-TextField-field\\\" min=\\\"1\\\" max=\\\"999\\\" placeholder=\\\"e.g. 3\\\"/> <span class=\\\"count-suffix\\\">times</span> </div> </div> <div class=\\\"project-option\\\"> <input type=\\\"checkbox\\\" id=\\\"project-4\\\" class=\\\"ms-CheckBox-input\\\"/> <label for=\\\"project-4\\\" class=\\\"ms-CheckBox-label\\\"> <span class=\\\"ms-CheckBox-field\\\"></span> <span class=\\\"ms-CheckBox-text\\\">Tables, Figures, and Listings Development</span> </label> </div> <div class=\\\"project-option\\\"> <input type=\\\"checkbox\\\" id=\\\"project-5\\\" class=\\\"ms-CheckBox-input\\\"/> <label for=\\\"project-5\\\" class=\\\"ms-CheckBox-label\\\"> <span class=\\\"ms-CheckBox-field\\\"></span> <span class=\\\"ms-CheckBox-text\\\">Interim Analysis</span> </label> </div> <div class=\\\"project-option\\\"> <input type=\\\"checkbox\\\" id=\\\"project-6\\\" class=\\\"ms-CheckBox-input\\\"/> <label for=\\\"project-6\\\" class=\\\"ms-CheckBox-label\\\"> <span class=\\\"ms-CheckBox-field\\\"></span> <span class=\\\"ms-CheckBox-text\\\">Final Analysis</span> </label> </div> <div class=\\\"project-option\\\"> <input type=\\\"checkbox\\\" id=\\\"project-7\\\" class=\\\"ms-CheckBox-input\\\"/> <label for=\\\"project-7\\\" class=\\\"ms-CheckBox-label\\\"> <span class=\\\"ms-CheckBox-field\\\"></span> <span class=\\\"ms-CheckBox-text\\\">DSUR First Time</span> </label> </div> <div class=\\\"project-option\\\"> <input type=\\\"checkbox\\\" id=\\\"project-8\\\" class=\\\"ms-CheckBox-input\\\" data-requires-count=\\\"dsur-rerun\\\"/> <label for=\\\"project-8\\\" class=\\\"ms-CheckBox-label\\\"> <span class=\\\"ms-CheckBox-field\\\"></span> <span class=\\\"ms-CheckBox-text\\\">DSUR Rerun</span> </label> <div class=\\\"count-input-container\\\" id=\\\"dsur-rerun-container\\\" style=\\\"display:none\\\"> <label class=\\\"count-label\\\">Rerun Times:</label> <input type=\\\"number\\\" id=\\\"dsur-rerun-count\\\" class=\\\"count-input ms-TextField-field\\\" min=\\\"1\\\" max=\\\"999\\\" placeholder=\\\"e.g. 4\\\"/> <span class=\\\"count-suffix\\\">times</span> </div> </div> <div class=\\\"project-option\\\"> <input type=\\\"checkbox\\\" id=\\\"project-9\\\" class=\\\"ms-CheckBox-input\\\"/> <label for=\\\"project-9\\\" class=\\\"ms-CheckBox-label\\\"> <span class=\\\"ms-CheckBox-field\\\"></span> <span class=\\\"ms-CheckBox-text\\\">DSMB/IDMC First Time</span> </label> </div> <div class=\\\"project-option\\\"> <input type=\\\"checkbox\\\" id=\\\"project-10\\\" class=\\\"ms-CheckBox-input\\\" data-requires-count=\\\"dsmb-rerun\\\"/> <label for=\\\"project-10\\\" class=\\\"ms-CheckBox-label\\\"> <span class=\\\"ms-CheckBox-field\\\"></span> <span class=\\\"ms-CheckBox-text\\\">DSMB Rerun</span> </label> <div class=\\\"count-input-container\\\" id=\\\"dsmb-rerun-container\\\" style=\\\"display:none\\\"> <label class=\\\"count-label\\\">Rerun Times:</label> <input type=\\\"number\\\" id=\\\"dsmb-rerun-count\\\" class=\\\"count-input ms-TextField-field\\\" min=\\\"1\\\" max=\\\"999\\\" placeholder=\\\"e.g. 2\\\"/> <span class=\\\"count-suffix\\\">times</span> </div> </div> </div> <div class=\\\"auto-save-section\\\"> <p class=\\\"auto-save-hint\\\"> Your selection will be automatically saved when you proceed.</p> </div> </div> <div class=\\\"sdtm-analysis-section wizard-page\\\" id=\\\"sdtm-analysis-section\\\" data-step=\\\"6\\\" style=\\\"display:none\\\"> <h3 class=\\\"ms-font-l\\\"> SDTM Analysis Results</h3> <div class=\\\"sdtm-summary\\\" id=\\\"sdtm-summary\\\"> <div class=\\\"summary-stats\\\"> <div class=\\\"stat-item\\\"> <span class=\\\"stat-label\\\">Procedures Found:</span> <span class=\\\"stat-value\\\" id=\\\"total-procedures\\\">0</span> </div> <div class=\\\"stat-item\\\"> <span class=\\\"stat-label\\\">SDTM Domains Found:</span> <span class=\\\"stat-value\\\" id=\\\"total-domains\\\">0</span> </div> </div> <div class=\\\"domains-overview\\\"> <span class=\\\"stat-label\\\">Identified Domains:</span> <div class=\\\"domains-list-overview\\\" id=\\\"domains-list-overview\\\"></div> </div> <div class=\\\"domains-overview\\\"> <span class=\\\"stat-label\\\">High Complexity SDTM:</span> <div class=\\\"domains-list-overview\\\" id=\\\"high-complexity-domains\\\"></div> </div> <div class=\\\"domains-overview\\\"> <span class=\\\"stat-label\\\">Medium Complexity SDTM:</span> <div class=\\\"domains-list-overview\\\" id=\\\"medium-complexity-domains\\\"></div> </div> </div> <div class=\\\"sdtm-status\\\" id=\\\"sdtm-status\\\" style=\\\"display:none\\\"> <i class=\\\"ms-Icon ms-Icon--Info\\\"></i> <span id=\\\"sdtm-status-text\\\">Analyzing procedures...</span> </div> <div class=\\\"sdtm-mappings-container\\\" id=\\\"sdtm-mappings-container\\\" style=\\\"display:none\\\"> <div class=\\\"mappings-header\\\"> <h4 class=\\\"ms-font-m\\\">Procedure  SDTM Domain Mappings</h4> <div class=\\\"mappings-actions\\\"> <button class=\\\"ms-Button ms-Button--small\\\" id=\\\"edit-mappings-btn\\\"> <span class=\\\"ms-Button-label\\\">Edit</span> </button> <button class=\\\"ms-Button ms-Button--primary\\\" id=\\\"confirm-mappings-btn\\\"> <span class=\\\"ms-Button-label\\\">Confirm & Save</span> </button> </div> </div> <div class=\\\"flat-mappings-list\\\" id=\\\"flat-mappings-list\\\"></div> <div class=\\\"confirmation-status\\\" id=\\\"confirmation-status\\\" style=\\\"display:none\\\"> <i class=\\\"ms-Icon ms-Icon--CheckMark\\\"></i> <span>SDTM Analysis Confirmed and Saved</span> </div> </div> </div> <div class=\\\"status-message\\\" id=\\\"status-message\\\"></div> <div class=\\\"wizard-nav\\\"> <button class=\\\"ms-Button\\\" id=\\\"wizard-back-btn\\\"><span class=\\\"ms-Button-label\\\">Back</span></button> <button class=\\\"ms-Button ms-Button--primary\\\" id=\\\"wizard-next-btn\\\"><span class=\\\"ms-Button-label\\\">Next</span></button> </div> </main> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","API_BASE_URL","currentWizardStep","initWizard","chatInput","chatSendBtn","backBtn","getElementById","nextBtn","addEventListener","_callee","_context","showStep","_callee2","_context2","handleNext","handleChatSend","key","shiftKey","preventDefault","sendBtn","hasText","trim","disabled","_handleChatSend","_callee4","userMessage","parsed","studyText","taskText","_context4","addChatMessage","pendingConfirmation","handleConfirmationResponse","showTypingIndicator","callAssistantParseCommand","hideTypingIndicator","studyIdentifier","matchedTask","toLowerCase","includes","delayedNavigation","name","askForConfirmation","_x","_callAssistantParseCommand","_callee5","text","resp","data","_context5","fetch","concat","method","headers","body","JSON","stringify","ok","json","taskName","taskKey","_x2","_handleConfirmationResponse","_callee6","intent","_window$pendingConfir","lookup","_context6","parseYesNoIntent","callAssistantLookupStudyTask","handleLookupResult","_x3","_parseYesNoIntent","_callee7","lowerText","noPatterns","_context7","type","some","pattern","_x4","_x5","_callAssistantLookupStudyTask","_callee8","_context8","_x6","_handleLookupResult","_callee0","_context0","foundStudy","isUnfinished","documentId","studyNumber","currentDocumentId","saveDocumentIdToSettings","delayedNavigationWithCallback","_callee9","_context9","restoreApplicationState","_x7","_delayedNavigation","_callee1","targetStep","delayMs","countdownDiv","chatMessages","_args1","_context1","setTimeout","createElement","className","innerHTML","appendChild","scrollTop","scrollHeight","remove","_x8","_x9","_delayedNavigationWithCallback","_callee10","callback","_args10","_context10","message","sender","messageDiv","contentDiv","textContent","typingDiv","id","typingIndicator","step","querySelectorAll","forEach","s","Number","getAttribute","style","display","navContainer","querySelector","_handleNext","_callee11","result","response","_docData$document","docData","sdtmData","hasValidConfirmed","source","_resp","_result","_t5","_t6","_t7","_context11","showStatusMessage","saveProjectSelectionDetails","console","warn","createStandardCostAnalysisHeaders","populateExcelWithSelectedProjects","success","confirmed","summary","total_sdtm_domains","Array","isArray","unique_domains","original","procedures","displaySDTMAnalysis","saveExcelToLocal","clearExcelContent","resetToStart","initFileUpload","protocolSelectBtn","protocolFileInput","protocolUploadArea","protocolCancelBtn","protocolRemoveBtn","click","handleProtocolUpload","target","files","cancelProtocolUpload","removeProtocolFile","handleDragOver","currentTarget","classList","dataTransfer","handleProtocolDrop","handleDragEnter","handleDragLeave","checkbox","countType","container","checked","input","focus","dropEffect","add","_x1","_handleProtocolUpload","_callee14","file","formData","_t0","_context14","showProtocolProgress","FormData","append","statusText","size","uploadId","showProtocolResult","error","hideProtocolProgress","_removeProtocolFile","_callee15","_context15","currentSDTMData","hideSDTMAnalysis","clearDocumentIdFromSettings","dataAttr","statusElement","_x10","_saveDocumentIdToSettings","_callee17","_t1","_context17","Excel","run","_ref8","_callee16","context","settings","_context16","workbook","getItem","delete","sync","log","_x14","loadDocumentIdFromSettings","_loadDocumentIdFromSettings","_callee19","_t10","_context19","_ref9","_callee18","documentIdSetting","_context18","load","_x15","_clearDocumentIdFromSettings","_callee21","_t11","_context21","_ref0","_callee20","_context20","_x16","_x11","_restoreApplicationState","_callee22","_document","_t12","_context22","mappings","projectSelectionDetails","restoreProjectSelections","checkboxes","entries","_ref4","_ref5","_slicedToArray","projectName","count","from","find","cb","label","nextElementSibling","contains","textSpan","Office","onReady","_ref3","_callee3","info","savedDocumentId","_t","_context3","host","HostType","_x0","isEditMode","sdtmAnalysis","inferredSuccess","_toConsumableArray","_objectSpread","sdtmSection","sdtmStatus","sdtmStatusText","sdtmMappingsContainer","updateSummaryStats","displayFlatMappingsList","editBtn","toggleEditMode","confirmBtn","confirmSDTMAnalysis","setupSDTMEventListeners","flatMappingsList","procedure","index","mapping","mappingRow","row","dataset","procedureName","domainsArea","sdtm_domains","domain","domainIndex","domainTag","createEditableDomainTag","addBtn","procedureIndex","push","newDomainIndex","newTag","makeTagEditable","addNewDomain","createMappingRow","domainText","mappingIndex","tag","removeBtn","stopPropagation","splice","removeDomain","contentEditable","originalText","range","createRange","selectNodeContents","selection","getSelection","removeAllRanges","addRange","finishEditing","newText","parseInt","parentNode","replaceChild","domainToComplexity","Map","complexity","existing","get","set","allDomains","keys","highDomains","filter","mediumDomains","total_procedures","highComplexitySdtm","domains","mediumComplexitySdtm","domainsOverview","highComplexityOverview","mediumComplexityOverview","updateSummaryAndDomainOverview","_confirmSDTMAnalysis","_callee23","_result$data","confirmationStatus","costEstimate","sdtmDataForNotes","docResp","_docData$document2","_docData$document3","snapshot","_t13","_t14","_context23","alert","applySDTMUnitsAndCostsToExcel","applySDTMNotesToExcel","_x12","_applySDTMUnitsAndCostsToExcel","_callee25","taskToKey","_t15","_context25","_ref1","_callee24","_snapshot$subtotal","sheet","used","startRow","startCol","rows","units","costs","subtotal","_units$key","_costs$key","task","unitVal","costVal","unitCell","estCostCell","sdtmStartRow","_r","_r2","subtotalCell","_context24","worksheets","getActiveWorksheet","getUsedRange","rowIndex","columnIndex","values","estimatedCosts","String","getRangeByIndexes","format","horizontalAlignment","_x17","_x13","_applySDTMNotesToExcel","_callee27","sdtmInfo","_sdtmInfo$summary","_sdtmInfo$summary2","_sdtmInfo$summary3","notesMap","_t16","_context27","join","_ref10","_callee26","note","noteCell","_context26","_x18","_saveExcelToLocal","_callee29","_t17","_context29","_ref11","_callee28","now","timestamp","fileName","_context28","Date","toISOString","slice","save","_x19","_clearExcelContent","_callee31","_t18","_context31","_ref12","_callee30","worksheet","usedRange","_context30","clear","_x20","_resetToStart","_callee32","_t19","_context32","_createStandardCostAnalysisHeaders","_callee34","_t20","_context34","_ref13","_callee33","headerRange","_context33","getRange","font","bold","fill","color","borders","autofitColumns","_x21","_populateExcelWithSelectedProjects","_callee36","_sdtmInfo","_sdtmInfo2","_sdtmInfo3","savedProjectDetails","_collectProjectSelect","_t21","_t22","_context36","collectProjectSelectionDetails","_ref14","_callee35","currentRow","_i","_Object$entries","_Object$entries$_i","isSDTM","isADAM","isDSUR","isDSMB","isStatisticalAnalysisPlan","projectNameRange","_i2","_sdtmSubItems","subItem","subItemRange","estimatedCostCell","_i3","_adamSubItems","_subItem","_subItemRange","_estimatedCostCell","_i4","_sapSubItems","_subItem2","_subItemRange2","_estimatedCostCell2","mainSubtotalRange","sectionStartRow","sectionEndRow","transferSubsection","transferRange","transferSubItems","_i5","_transferSubItems","transferSubItem","transferSubItemRange","transferSubtotalRange","rerunSubsection","rerunRange","rerunSubtotalRange","_projectNameRange","subtotalRange","_i6","_defaultSections","sectionName","_subtotalRange","grandTotalRange","_context35","unit","costPerHour","hoursPerUnit","costPerUnit","formulas","numberFormat","_x22","parentElement","requiresCount","countInput","_saveProjectSelectionDetails","_callee37","_collectProjectSelect2","_t23","_context37","URL"],"sourceRoot":""}