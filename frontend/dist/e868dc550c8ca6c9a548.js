/*! For license information please see e868dc550c8ca6c9a548.js.LICENSE.txt */
function _regenerator(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var i=r&&r.prototype instanceof s?r:s,u=Object.create(i.prototype);return _regeneratorDefine2(u,"_invoke",function(n,r,o){var a,s,i,u=0,l=o||[],d=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return a=t,s=0,i=e,p.n=n,c}};function f(n,r){for(s=n,i=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,a=l[t],f=p.p,g=a[2];n>3?(o=g===r)&&(i=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=f&&((o=n<2&&f<a[1])?(s=0,p.v=r,p.n=a[1]):f<g&&(o=n<3||a[0]>r||r>g)&&(a[4]=n,a[5]=r,p.n=g,s=0))}if(o||n>1)return c;throw d=!0,r}return function(o,l,g){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&f(l,g),s=l,i=g;(t=s<2?e:i)||!d;){a||(s?s<3?(s>1&&(p.n=-1),f(s,i)):p.n=i:p.v=i);try{if(u=2,a){if(s||(o="next"),t=a[o]){if(!(t=t.call(a,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,s<2&&(s=0)}else 1===s&&(t=a.return)&&t.call(a),s<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=e}else if((t=(d=p.n<0)?i:n.call(r,p))!==c)break}catch(t){a=e,s=1,i=t}finally{u=1}}return{value:t,done:d}}}(n,o,a),!0),u}var c={};function s(){}function i(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(_regeneratorDefine2(t={},r,function(){return this}),t),d=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return i.prototype=u,_regeneratorDefine2(d,"constructor",u),_regeneratorDefine2(u,"constructor",i),i.displayName="GeneratorFunction",_regeneratorDefine2(u,o,"GeneratorFunction"),_regeneratorDefine2(d),_regeneratorDefine2(d,o,"Generator"),_regeneratorDefine2(d,r,function(){return this}),_regeneratorDefine2(d,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:a,m:p}})()}function _regeneratorDefine2(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}_regeneratorDefine2=function(e,t,n,r){function a(t,n){_regeneratorDefine2(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},_regeneratorDefine2(e,t,n,r)}function asyncGeneratorStep(e,t,n,r,o,a,c){try{var s=e[a](c),i=s.value}catch(e){return void n(e)}s.done?t(i):Promise.resolve(i).then(r,o)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function c(e){asyncGeneratorStep(a,r,o,c,s,"next",e)}function s(e){asyncGeneratorStep(a,r,o,c,s,"throw",e)}c(void 0)})}}var API_BASE_URL="https://localhost:4000",uploadedProtocol=null,currentWizardStep=1,lastParsedCommand=null,excelStateCache={step1:null,step2:null,step3:null,step4:null,step5:null,step6:null},isTrackingChanges=!1,changeTimeout=null;function initializeApplication(){return _initializeApplication.apply(this,arguments)}function _initializeApplication(){return(_initializeApplication=_asyncToGenerator(_regenerator().m(function e(){var t;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("🚀 初始化主控制器..."),initWizard(),e.n=1,initializeModules();case 1:return e.n=2,initExcelChangeTracking();case 2:return e.n=3,attemptStateRecovery();case 3:console.log("✅ 主控制器初始化完成"),e.n=5;break;case 4:e.p=4,t=e.v,console.error("❌ 主控制器初始化失败:",t),showStatusMessage("Application initialization failed","error"),showStep(1);case 5:return e.a(2)}},e,null,[[0,4]])}))).apply(this,arguments)}function initializeModules(){return _initializeModules.apply(this,arguments)}function _initializeModules(){return(_initializeModules=_asyncToGenerator(_regenerator().m(function e(){var t;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,void 0!==window.MainPageModule){e.n=1;break}console.warn("⚠️ MainPage 模块未加载"),e.n=2;break;case 1:return e.n=2,window.MainPageModule.init({API_BASE_URL:API_BASE_URL,showStep:showStep,showStatusMessage:showStatusMessage,delayedNavigation:delayedNavigation,saveDocumentIdToSettings:saveDocumentIdToSettings,setCurrentDocumentId:function(e){window.currentDocumentId=e},setUploadedProtocol:function(e){uploadedProtocol=e}});case 2:if(void 0!==window.CostEstimateModule){e.n=3;break}console.warn("⚠️ CostEstimate 模块未加载"),e.n=4;break;case 3:return e.n=4,window.CostEstimateModule.init({API_BASE_URL:API_BASE_URL,showStep:showStep,showStatusMessage:showStatusMessage,cacheExcelState:cacheExcelState,restoreExcelState:restoreExcelState,clearDocumentIdFromSettings:clearDocumentIdFromSettings,setUploadedProtocol:function(e){uploadedProtocol=e},getCurrentDocumentId:function(){return window.currentDocumentId},setCurrentDocumentId:function(e){window.currentDocumentId=e}});case 4:console.log("✅ 所有模块初始化完成"),e.n=6;break;case 5:throw e.p=5,t=e.v,console.error("❌ 模块初始化失败:",t),t;case 6:return e.a(2)}},e,null,[[0,5]])}))).apply(this,arguments)}function initWizard(){currentWizardStep=1;var e=document.getElementById("wizard-back-btn"),t=document.getElementById("wizard-next-btn");e&&e.addEventListener("click",_asyncToGenerator(_regenerator().m(function e(){var t;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(!(currentWizardStep>1)){e.n=2;break}return t=currentWizardStep-1,e.n=1,restoreExcelState(t);case 1:showStep(t);case 2:return e.a(2)}},e)}))),t&&t.addEventListener("click",_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,handleNext();case 1:return e.a(2)}},e)}))),cacheExcelState(1)}function showStep(e){currentWizardStep=e,document.querySelectorAll(".wizard-page").forEach(function(t){var n=Number(t.getAttribute("data-step"));t.style.display=n===e?"block":"none"});var t=document.getElementById("wizard-back-btn"),n=document.getElementById("wizard-next-btn"),r=document.querySelector(".wizard-nav");if(1===e)r&&(r.style.display="none");else if(r&&(r.style.display="flex"),t&&(t.disabled=!1),n){n.disabled=!1;var o=n.querySelector(".ms-Button-label");o&&(o.textContent=6===e?"Done":"Next")}notifyModuleStepChange(e)}function handleNext(){return _handleNext.apply(this,arguments)}function _handleNext(){return(_handleNext=_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(1!==currentWizardStep){e.n=1;break}return console.warn("Step 1 Next应该由AI Assistant模块处理"),e.a(2);case 1:if(2!==currentWizardStep){e.n=5;break}if(!window.MainPageModule||!window.MainPageModule.handleNext){e.n=3;break}return e.n=2,window.MainPageModule.handleNext(currentWizardStep);case 2:e.n=4;break;case 3:return e.n=4,handleNextFallback(currentWizardStep);case 4:case 8:case 9:return e.a(2);case 5:if(!(currentWizardStep>=3&&currentWizardStep<=6)){e.n=9;break}if(!window.CostEstimateModule||!window.CostEstimateModule.handleNext){e.n=7;break}return e.n=6,window.CostEstimateModule.handleNext(currentWizardStep);case 6:e.n=8;break;case 7:return e.n=8,handleNextFallback(currentWizardStep)}},e)}))).apply(this,arguments)}function handleNextFallback(e){return _handleNextFallback.apply(this,arguments)}function _handleNextFallback(){return(_handleNextFallback=_asyncToGenerator(_regenerator().m(function e(t){var n,r,o,a;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:console.warn("模块未实现handleNext，使用降级处理: Step ".concat(t)),o=t,e.n=2===o?1:3===o?4:4===o||5===o?13:6===o?15:27;break;case 1:return e.n=2,cacheExcelState(2);case 2:if(window.currentDocumentId){e.n=3;break}return showStatusMessage("Please upload a protocol document before proceeding.","error"),e.a(2);case 3:return showStep(3),e.a(3,27);case 4:if(!window.CostEstimateModule||!window.CostEstimateModule.saveProjectSelectionDetails){e.n=12;break}return e.p=5,e.n=6,window.CostEstimateModule.saveProjectSelectionDetails();case 6:if(console.log("✅ 项目选择已保存，状态: project_selection_done"),!window.CostEstimateModule.createStandardCostAnalysisHeaders){e.n=7;break}return e.n=7,window.CostEstimateModule.createStandardCostAnalysisHeaders();case 7:if(!window.CostEstimateModule.populateExcelWithSelectedProjects){e.n=8;break}return e.n=8,window.CostEstimateModule.populateExcelWithSelectedProjects();case 8:return e.n=9,cacheExcelState(t);case 9:return showStep(t+1),e.n=10,triggerSDTMAnalysis();case 10:e.n=12;break;case 11:return e.p=11,a=e.v,console.error("❌ 保存项目选择失败:",a),showStatusMessage("Failed to save project selection","error"),e.a(2);case 12:return e.a(3,27);case 13:return e.n=14,cacheExcelState(t);case 14:return showStep(t+1),e.a(3,27);case 15:return e.n=16,cacheExcelState(6);case 16:if(window.currentDocumentId){e.n=17;break}return showStatusMessage("Missing document id. Please upload again.","error"),e.a(2);case 17:return e.p=17,e.n=18,fetch("".concat(API_BASE_URL,"/api/documents/").concat(window.currentDocumentId,"/mark-complete"),{method:"PATCH"});case 18:return n=e.v,e.n=19,n.json();case 19:if(null==(r=e.v)||!r.success){e.n=23;break}if(showStatusMessage("Project completed! Saving Excel file and starting fresh...","success"),!window.CostEstimateModule||!window.CostEstimateModule.saveExcelToLocal){e.n=20;break}return e.n=20,window.CostEstimateModule.saveExcelToLocal();case 20:if(!window.CostEstimateModule||!window.CostEstimateModule.clearExcelContent){e.n=21;break}return e.n=21,window.CostEstimateModule.clearExcelContent();case 21:if(!window.CostEstimateModule||!window.CostEstimateModule.resetToStart){e.n=22;break}return e.n=22,window.CostEstimateModule.resetToStart();case 22:e.n=24;break;case 23:showStatusMessage("Failed to mark as completed: "+((null==r?void 0:r.message)||""),"error");case 24:e.n=26;break;case 25:e.p=25,showStatusMessage("Failed to mark as completed: "+e.v.message,"error");case 26:return e.a(3,27);case 27:return e.a(2)}},e,null,[[17,25],[5,11]])}))).apply(this,arguments)}function delayedNavigation(e){return _delayedNavigation.apply(this,arguments)}function _delayedNavigation(){return _delayedNavigation=_asyncToGenerator(_regenerator().m(function e(t){var n,r=arguments;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:2e3,e.n=1,new Promise(function(e){return setTimeout(e,n)});case 1:showStep(t);case 2:return e.a(2)}},e)})),_delayedNavigation.apply(this,arguments)}function triggerSDTMAnalysis(){return _triggerSDTMAnalysis.apply(this,arguments)}function _triggerSDTMAnalysis(){return(_triggerSDTMAnalysis=_asyncToGenerator(_regenerator().m(function e(){var t,n,r;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,console.log("🔄 开始自动触发SDTM分析..."),t=window.currentDocumentId){e.n=1;break}throw new Error("No document ID available");case 1:return e.n=2,fetch("".concat(API_BASE_URL,"/api/documents/").concat(t,"/analyze-sdtm"),{method:"POST",headers:{"Content-Type":"application/json"}});case 2:if((n=e.v).ok){e.n=3;break}throw new Error("SDTM analysis failed: ".concat(n.statusText));case 3:return e.n=4,n.json();case 4:e.v,console.log("✅ SDTM分析完成，状态: sdtm_ai_analysis_done"),setTimeout(_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(showStep(5),!window.CostEstimateModule||!window.CostEstimateModule.loadAndDisplaySDTMResults){e.n=1;break}return e.n=1,window.CostEstimateModule.loadAndDisplaySDTMResults();case 1:return e.a(2)}},e)})),2e3),e.n=6;break;case 5:e.p=5,r=e.v,console.error("❌ SDTM分析失败:",r),showStatusMessage("SDTM Analysis failed: "+r.message,"error");case 6:return e.a(2)}},e,null,[[0,5]])}))).apply(this,arguments)}function notifyModuleStepChange(e){e<=2&&window.MainPageModule&&window.MainPageModule.onStepEnter?window.MainPageModule.onStepEnter(e):e>=3&&e<=6&&window.CostEstimateModule&&window.CostEstimateModule.onStepEnter&&window.CostEstimateModule.onStepEnter(e)}function cacheExcelState(e){return _cacheExcelState.apply(this,arguments)}function _cacheExcelState(){return _cacheExcelState=_asyncToGenerator(_regenerator().m(function e(t){var n;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m(function e(n){var r,o;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(r=n.workbook.worksheets.getActiveWorksheet(),!(o=r.getUsedRange())){e.n=2;break}return o.load(["values","formulas"]),e.n=1,n.sync();case 1:excelStateCache["step".concat(t)]={values:o.values,formulas:o.formulas,rowCount:o.rowCount,columnCount:o.columnCount},e.n=3;break;case 2:excelStateCache["step".concat(t)]=null;case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:console.log("✅ 缓存Step ".concat(t," Excel状态成功")),e.n=3;break;case 2:e.p=2,n=e.v,console.warn("⚠️ 缓存Step ".concat(t," Excel状态失败:"),n);case 3:return e.a(2)}},e,null,[[0,2]])})),_cacheExcelState.apply(this,arguments)}function restoreExcelState(e){return _restoreExcelState.apply(this,arguments)}function _restoreExcelState(){return _restoreExcelState=_asyncToGenerator(_regenerator().m(function e(t){var n,r;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n=excelStateCache["step".concat(t)],e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m(function e(t){var r,o,a,c,s;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(r=t.workbook.worksheets.getActiveWorksheet(),!(o=r.getUsedRange())){e.n=1;break}return o.clear(),e.n=1,t.sync();case 1:if(!n||!n.values){e.n=2;break}return a=n.rowCount,c=n.columnCount,(s=r.getRange(0,0,a,c)).values=n.values,n.formulas&&(s.formulas=n.formulas),e.n=2,t.sync();case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:console.log("✅ 恢复Step ".concat(t," Excel状态成功")),e.n=3;break;case 2:e.p=2,r=e.v,console.warn("⚠️ 恢复Step ".concat(t," Excel状态失败:"),r);case 3:return e.a(2)}},e,null,[[0,2]])})),_restoreExcelState.apply(this,arguments)}function initExcelChangeTracking(){return _initExcelChangeTracking.apply(this,arguments)}function _initExcelChangeTracking(){return _initExcelChangeTracking=_asyncToGenerator(_regenerator().m(function e(){var t;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m(function e(t){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:t.workbook.worksheets.getActiveWorksheet().onChanged.add(function(){var e=_asyncToGenerator(_regenerator().m(function e(t){var n;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m(function e(n){var r,o,a,c;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return r=n.workbook.worksheets.getItem(t.worksheetId),(o=r.getRange(t.address)).load(["columnIndex","columnCount"]),e.n=1,n.sync();case 1:if(a=o.columnIndex,c=a+o.columnCount-1,a<=1&&c>=1){e.n=2;break}return e.a(2);case 2:changeTimeout&&clearTimeout(changeTimeout),changeTimeout=setTimeout(_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(!window.CostEstimateModule||!window.CostEstimateModule.saveExcelChangesToDatabase){e.n=1;break}return e.n=1,window.CostEstimateModule.saveExcelChangesToDatabase();case 1:return e.a(2)}},e)})),1e3);case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.warn("Excel变化处理失败:",n);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:isTrackingChanges=!0,console.log("✅ Excel变化监听初始化成功"),e.n=3;break;case 2:e.p=2,t=e.v,console.error("❌ Excel变化监听初始化失败:",t);case 3:return e.a(2)}},e,null,[[0,2]])})),_initExcelChangeTracking.apply(this,arguments)}function showStatusMessage(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";console.log("[".concat(t.toUpperCase(),"] ").concat(e));var n=document.getElementById("status-message");n||((n=document.createElement("div")).id="status-message",n.className="status-message",document.body.appendChild(n)),n.textContent=e,n.className="status-message ".concat(t),n.style.display="block",setTimeout(function(){n.style.display="none"},3e3)}function saveDocumentIdToSettings(e){return _saveDocumentIdToSettings.apply(this,arguments)}function _saveDocumentIdToSettings(){return _saveDocumentIdToSettings=_asyncToGenerator(_regenerator().m(function e(t){var n;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m(function e(n){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return n.workbook.settings.add("currentDocumentId",t),e.n=1,n.sync();case 1:window.currentDocumentId=t,console.log("✅ 文档ID已保存: ".concat(t));case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.error("❌ 保存文档ID失败:",n);case 3:return e.a(2)}},e,null,[[0,2]])})),_saveDocumentIdToSettings.apply(this,arguments)}function loadDocumentIdFromSettings(){return _loadDocumentIdFromSettings.apply(this,arguments)}function _loadDocumentIdFromSettings(){return _loadDocumentIdFromSettings=_asyncToGenerator(_regenerator().m(function e(){var t;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m(function e(t){var n,r,o;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return n=t.workbook.settings,(r=n.getItemOrNullObject("currentDocumentId")).load("value"),e.n=1,t.sync();case 1:if(!r.isNullObject){e.n=2;break}return e.a(2,null);case 2:return o=r.value,window.currentDocumentId=o,console.log("✅ 文档ID已加载: ".concat(o)),e.a(2,o)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2,e.v);case 2:return e.p=2,t=e.v,console.error("❌ 加载文档ID失败:",t),e.a(2,null)}},e,null,[[0,2]])})),_loadDocumentIdFromSettings.apply(this,arguments)}function clearDocumentIdFromSettings(){return _clearDocumentIdFromSettings.apply(this,arguments)}function _clearDocumentIdFromSettings(){return _clearDocumentIdFromSettings=_asyncToGenerator(_regenerator().m(function e(){var t;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m(function e(t){var n,r;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return n=t.workbook.settings,r=n.getItemOrNullObject("currentDocumentId"),e.n=1,t.sync();case 1:if(r.isNullObject){e.n=2;break}return r.delete(),e.n=2,t.sync();case 2:window.currentDocumentId=null,console.log("✅ 文档ID已清除");case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("❌ 清除文档ID失败:",t);case 3:return e.a(2)}},e,null,[[0,2]])})),_clearDocumentIdFromSettings.apply(this,arguments)}function attemptStateRecovery(){return _attemptStateRecovery.apply(this,arguments)}function _attemptStateRecovery(){return(_attemptStateRecovery=_asyncToGenerator(_regenerator().m(function e(){var t,n;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,loadDocumentIdFromSettings();case 1:if(!(t=e.v)){e.n=3;break}if(console.log("🔄 发现已保存的文档ID，尝试恢复状态..."),!window.CostEstimateModule||!window.CostEstimateModule.restoreApplicationState){e.n=2;break}return e.n=2,window.CostEstimateModule.restoreApplicationState(t);case 2:showStep(5),e.n=4;break;case 3:showStep(1);case 4:e.n=6;break;case 5:e.p=5,n=e.v,console.error("❌ 状态恢复失败:",n),showStep(1);case 6:return e.a(2)}},e,null,[[0,5]])}))).apply(this,arguments)}Office.onReady(function(){var e=_asyncToGenerator(_regenerator().m(function e(t){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(t.host!==Office.HostType.Excel){e.n=1;break}return document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",e.n=1,initializeApplication();case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),window.triggerSDTMAnalysis=triggerSDTMAnalysis,window.TaskPaneController={showStep:showStep,showStatusMessage:showStatusMessage,delayedNavigation:delayedNavigation,cacheExcelState:cacheExcelState,restoreExcelState:restoreExcelState,getCurrentStep:function(){return currentWizardStep},getUploadedProtocol:function(){return uploadedProtocol},setUploadedProtocol:function(e){uploadedProtocol=e},saveDocumentIdToSettings:saveDocumentIdToSettings,loadDocumentIdFromSettings:loadDocumentIdFromSettings,clearDocumentIdFromSettings:clearDocumentIdFromSettings,API_BASE_URL:API_BASE_URL};